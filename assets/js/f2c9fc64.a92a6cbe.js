"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[2116],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(96540);const r={},d=s.createContext(r);function t(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(d.Provider,{value:n},e.children)}},96573:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"servicios-corporativos/servicio-identidad/decisiones-arquitectura","title":"9. Decisiones de arquitectura","description":"Esta secci\xf3n documenta las decisiones arquitect\xf3nicas clave del sistema de identidad, siguiendo el formato ADR y alineando cada decisi\xf3n a los principios de portabilidad, est\xe1ndares abiertos, multi-tenant y operaci\xf3n cloud-agnostic.","source":"@site/docs/servicios-corporativos/servicio-identidad/09-decisiones-arquitectura.md","sourceDirName":"servicios-corporativos/servicio-identidad","slug":"/servicios-corporativos/servicio-identidad/decisiones-arquitectura","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-identidad/decisiones-arquitectura","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-identidad/09-decisiones-arquitectura.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"8. Conceptos transversales","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-identidad/conceptos-transversales"},"next":{"title":"10. Requisitos de calidad","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-identidad/requisitos-calidad"}}');var r=i(74848),d=i(28453);const t={},a="9. Decisiones de arquitectura",l={},c=[{value:"9.1 Decisiones principales",id:"91-decisiones-principales",level:2},{value:"9.2 Alternativas evaluadas",id:"92-alternativas-evaluadas",level:2},{value:"9.3 Resumen de decisiones",id:"93-resumen-de-decisiones",level:2},{value:"9.4 Principios arquitect\xf3nicos",id:"94-principios-arquitect\xf3nicos",level:2},{value:"9.5 Referencias",id:"95-referencias",level:2},{value:"9.1 Decisiones principales",id:"91-decisiones-principales-1",level:2},{value:"9.2 Alternativas evaluadas",id:"92-alternativas-evaluadas-1",level:2},{value:"ADR-001: <code>Keycloak</code> containerizado como identity provider central",id:"adr-001-keycloak-containerizado-como-identity-provider-central",level:2},{value:"Contexto",id:"contexto",level:3},{value:"Alternativas consideradas",id:"alternativas-consideradas",level:3},{value:"Decisi\xf3n",id:"decisi\xf3n",level:3},{value:"Arquitectura containerizada",id:"arquitectura-containerizada",level:3},{value:"Configuraci\xf3n multi-tenant (realms)",id:"configuraci\xf3n-multi-tenant-realms",level:3},{value:"Justificaci\xf3n",id:"justificaci\xf3n",level:3},{value:"Consecuencias",id:"consecuencias",level:3},{value:"ADR-002: JWT con RS256 como formato de token est\xe1ndar",id:"adr-002-jwt-con-rs256-como-formato-de-token-est\xe1ndar",level:2},{value:"Contexto",id:"contexto-1",level:3},{value:"Alternativas consideradas",id:"alternativas-consideradas-1",level:3},{value:"Decisi\xf3n",id:"decisi\xf3n-1",level:3},{value:"Justificaci\xf3n",id:"justificaci\xf3n-1",level:3},{value:"Token structure",id:"token-structure",level:3},{value:"Key management strategy",id:"key-management-strategy",level:3},{value:"Consecuencias",id:"consecuencias-1",level:3},{value:"ADR-003: Multi-realm strategy para aislamiento multi-tenant",id:"adr-003-multi-realm-strategy-para-aislamiento-multi-tenant",level:2},{value:"Contexto",id:"contexto-2",level:3},{value:"Alternativas consideradas",id:"alternativas-consideradas-2",level:3},{value:"Decisi\xf3n",id:"decisi\xf3n-2",level:3},{value:"Arquitectura de realms",id:"arquitectura-de-realms",level:3},{value:"Tenant resolution strategy",id:"tenant-resolution-strategy",level:3},{value:"Justificaci\xf3n",id:"justificaci\xf3n-2",level:3},{value:"Consecuencias",id:"consecuencias-2",level:3},{value:"ADR-004: Redis cluster para token validation caching",id:"adr-004-redis-cluster-para-token-validation-caching",level:2},{value:"Contexto",id:"contexto-3",level:3},{value:"Problema",id:"problema",level:3},{value:"Alternativas consideradas",id:"alternativas-consideradas-3",level:3},{value:"Decisi\xf3n",id:"decisi\xf3n-3",level:3},{value:"Cache strategy",id:"cache-strategy",level:3},{value:"Implementation",id:"implementation",level:3},{value:"Infrastructure configuration",id:"infrastructure-configuration",level:3},{value:"Justificaci\xf3n",id:"justificaci\xf3n-3",level:3},{value:"Consecuencias",id:"consecuencias-3",level:3},{value:"ADR-005: Event sourcing para audit trail compliance",id:"adr-005-event-sourcing-para-audit-trail-compliance",level:2},{value:"Contexto",id:"contexto-4",level:3},{value:"Alternativas consideradas",id:"alternativas-consideradas-4",level:3},{value:"Decisi\xf3n",id:"decisi\xf3n-4",level:3},{value:"Event store architecture",id:"event-store-architecture",level:3},{value:"Event schema design",id:"event-schema-design",level:3},{value:"Event store implementation",id:"event-store-implementation",level:3},{value:"Real-time event processing",id:"real-time-event-processing",level:3},{value:"Justificaci\xf3n",id:"justificaci\xf3n-4",level:3},{value:"Consecuencias",id:"consecuencias-4",level:3},{value:"Resumen de decisiones",id:"resumen-de-decisiones",level:2},{value:"Referencias",id:"referencias",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"9-decisiones-de-arquitectura",children:"9. Decisiones de arquitectura"})}),"\n",(0,r.jsx)(n.p,{children:"Esta secci\xf3n documenta las decisiones arquitect\xf3nicas clave del sistema de identidad, siguiendo el formato ADR y alineando cada decisi\xf3n a los principios de portabilidad, est\xe1ndares abiertos, multi-tenant y operaci\xf3n cloud-agnostic."}),"\n",(0,r.jsx)(n.h2,{id:"91-decisiones-principales",children:"9.1 Decisiones principales"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"ADR"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"}),(0,r.jsx)(n.th,{children:"Estado"}),(0,r.jsx)(n.th,{children:"Justificaci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-001"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Keycloak"})," como IdP"]}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Open source maduro"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-002"}),(0,r.jsxs)(n.td,{children:["Multi-tenant (",(0,r.jsx)(n.code,{children:"realm"}),") por pa\xeds"]}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Aislamiento total"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-003"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PostgreSQL"})," backend"]}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Robustez"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-004"}),(0,r.jsx)(n.td,{children:"Federaci\xf3n h\xedbrida"}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Flexibilidad"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"92-alternativas-evaluadas",children:"9.2 Alternativas evaluadas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Componente"}),(0,r.jsx)(n.th,{children:"Alternativas"}),(0,r.jsx)(n.th,{children:"Selecci\xf3n"}),(0,r.jsx)(n.th,{children:"Raz\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IdP"}),(0,r.jsxs)(n.td,{children:["Auth0, Okta, ",(0,r.jsx)(n.code,{children:"Keycloak"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Keycloak"})}),(0,r.jsx)(n.td,{children:"Control total"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Base de datos"}),(0,r.jsxs)(n.td,{children:["MySQL, ",(0,r.jsx)(n.code,{children:"PostgreSQL"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PostgreSQL"})}),(0,r.jsx)(n.td,{children:"Compatibilidad"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Deployment"}),(0,r.jsx)(n.td,{children:"VM, Container, K8s"}),(0,r.jsx)(n.td,{children:"Container"}),(0,r.jsx)(n.td,{children:"Portabilidad"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Federaci\xf3n"}),(0,r.jsx)(n.td,{children:"Full, None, H\xedbrida"}),(0,r.jsx)(n.td,{children:"H\xedbrida"}),(0,r.jsx)(n.td,{children:"Gradual"})]})]})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Todas las decisiones siguen los principios: agn\xf3stico de nube, sin desarrollo personalizado, basado en est\xe1ndares, multi-tenant (",(0,r.jsx)(n.code,{children:"realm"}),"), contenedores primero, sin dependencia de proveedor. Cada ADR documenta contexto, justificaci\xf3n y consecuencias."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"93-resumen-de-decisiones",children:"9.3 Resumen de decisiones"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"#"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"}),(0,r.jsx)(n.th,{children:"Estado"}),(0,r.jsx)(n.th,{children:"Impacto"}),(0,r.jsx)(n.th,{children:"Fecha"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-001"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Keycloak"})," containerizado"]}),(0,r.jsx)(n.td,{children:"Aprobado"}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"2024-01-15"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-002"}),(0,r.jsxs)(n.td,{children:["Multi-tenant (",(0,r.jsx)(n.code,{children:"realm"}),")"]}),(0,r.jsx)(n.td,{children:"Aprobado"}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"2024-01-20"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-003"}),(0,r.jsx)(n.td,{children:"Database-backed Sessions"}),(0,r.jsx)(n.td,{children:"Aprobado"}),(0,r.jsx)(n.td,{children:"Medio"}),(0,r.jsx)(n.td,{children:"2024-01-25"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-004"}),(0,r.jsx)(n.td,{children:"OAuth2 + OIDC Standard"}),(0,r.jsx)(n.td,{children:"Aprobado"}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"2024-01-30"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"94-principios-arquitect\xf3nicos",children:"9.4 Principios arquitect\xf3nicos"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Portabilidad entre nubes: ",(0,r.jsx)(n.code,{children:"Keycloak"})," y ",(0,r.jsx)(n.code,{children:"PostgreSQL"})," desplegables en AWS, Azure, GCP o on-premise"]}),"\n",(0,r.jsxs)(n.li,{children:["Sin desarrollo personalizado: Uso de ",(0,r.jsx)(n.code,{children:"Keycloak"})," y ",(0,r.jsx)(n.code,{children:"PostgreSQL"})," listos para usar"]}),"\n",(0,r.jsx)(n.li,{children:"Est\xe1ndares abiertos: OAuth2, OIDC, SAML 2.0 para m\xe1xima interoperabilidad"}),"\n",(0,r.jsxs)(n.li,{children:["Multi-tenant (",(0,r.jsx)(n.code,{children:"realm"}),") por pa\xeds: Aislamiento total de datos y configuraci\xf3n"]}),"\n",(0,r.jsxs)(n.li,{children:["Contenedores y orquestaci\xf3n: ",(0,r.jsx)(n.code,{children:"Docker"}),"/",(0,r.jsx)(n.code,{children:"Kubernetes"})," como base de despliegue"]}),"\n",(0,r.jsx)(n.li,{children:"Independencia de proveedor: Sin lock-in, migraci\xf3n sencilla"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"95-referencias",children:"9.5 Referencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.arc42.org/section-9/",children:"Arc42 ADR Template"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.keycloak.org/architecture/",children:"Keycloak Architecture"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://c4model.com/",children:"C4 Model for Software Architecture"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h1,{id:"9-decisiones-de-arquitectura-detalle-adr",children:"9. Decisiones de arquitectura (detalle ADR)"}),"\n",(0,r.jsx)(n.h2,{id:"91-decisiones-principales-1",children:"9.1 Decisiones principales"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"ADR"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"}),(0,r.jsx)(n.th,{children:"Estado"}),(0,r.jsx)(n.th,{children:"Justificaci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-001"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Keycloak"})," como IdP"]}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Open source maduro"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-002"}),(0,r.jsx)(n.td,{children:"Multi-realm por pa\xeds"}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Aislamiento completo"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-003"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"PostgreSQL"})," backend"]}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Robustez"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-004"}),(0,r.jsx)(n.td,{children:"Federaci\xf3n h\xedbrida"}),(0,r.jsx)(n.td,{children:"Aceptado"}),(0,r.jsx)(n.td,{children:"Flexibilidad"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"92-alternativas-evaluadas-1",children:"9.2 Alternativas evaluadas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Componente"}),(0,r.jsx)(n.th,{children:"Alternativas"}),(0,r.jsx)(n.th,{children:"Selecci\xf3n"}),(0,r.jsx)(n.th,{children:"Raz\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IdP"}),(0,r.jsxs)(n.td,{children:["Auth0, Okta, ",(0,r.jsx)(n.code,{children:"Keycloak"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Keycloak"})}),(0,r.jsx)(n.td,{children:"Control total"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Base datos"}),(0,r.jsxs)(n.td,{children:["MySQL, ",(0,r.jsx)(n.code,{children:"PostgreSQL"})]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PostgreSQL"})}),(0,r.jsx)(n.td,{children:"Compatibilidad"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Deployment"}),(0,r.jsx)(n.td,{children:"VM, Container, K8s"}),(0,r.jsx)(n.td,{children:"Container"}),(0,r.jsx)(n.td,{children:"Portabilidad"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Federaci\xf3n"}),(0,r.jsx)(n.td,{children:"Full, None, H\xedbrida"}),(0,r.jsx)(n.td,{children:"H\xedbrida"}),(0,r.jsx)(n.td,{children:"Gradual"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Esta secci\xf3n documenta las decisiones arquitect\xf3nicas m\xe1s importantes del sistema de identidad utilizando el formato ADR, proporcionando contexto, justificaci\xf3n y consecuencias de cada decisi\xf3n."}),"\n",(0,r.jsxs)(n.h2,{id:"adr-001-keycloak-containerizado-como-identity-provider-central",children:["ADR-001: ",(0,r.jsx)(n.code,{children:"Keycloak"})," containerizado como identity provider central"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Valor"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Estado"}),(0,r.jsx)(n.td,{children:"\u2705 Aprobado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fecha"}),(0,r.jsx)(n.td,{children:"2024-01-15"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Decidido por"}),(0,r.jsx)(n.td,{children:"Equipo de Arquitectura, CISO"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Interesados"}),(0,r.jsx)(n.td,{children:"Desarrollo, Seguridad, Operaciones"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"contexto",children:"Contexto"}),"\n",(0,r.jsx)(n.p,{children:"La organizaci\xf3n requiere centralizar la gesti\xf3n de identidades para m\xfaltiples aplicaciones corporativas distribuidas en 4 pa\xedses (Per\xfa, Ecuador, Colombia, M\xe9xico), con enfoque en portabilidad agn\xf3stica de nube y sin desarrollo personalizado dentro del servicio de identidad."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requisitos espec\xedficos:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Soluci\xf3n contenedorizada lista para usar"}),"\n",(0,r.jsx)(n.li,{children:"Soporte para OAuth2/OIDC y SAML 2.0"}),"\n",(0,r.jsx)(n.li,{children:"Multi-tenancy con aislamiento por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Federaci\xf3n con Google Workspace y Active Directory"}),"\n",(0,r.jsx)(n.li,{children:"Cumplimiento con GDPR, SOX y regulaciones locales"}),"\n",(0,r.jsx)(n.li,{children:"Agn\xf3stico de nube: Portable entre AWS, Azure, GCP"}),"\n",(0,r.jsxs)(n.li,{children:["Cero desarrollo personalizado: Usar ",(0,r.jsx)(n.code,{children:"Keycloak"})," listo para usar"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternativas-consideradas",children:"Alternativas consideradas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Soluci\xf3n"}),(0,r.jsx)(n.th,{children:"Portabilidad"}),(0,r.jsx)(n.th,{children:"Desarrollo Custom"}),(0,r.jsx)(n.th,{children:"Costo/A\xf1o"}),(0,r.jsx)(n.th,{children:"Vendor Lock-in"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Keycloak"})," Container"]}),(0,r.jsx)(n.td,{children:"\u2705 Full"}),(0,r.jsx)(n.td,{children:"\u274c None required"}),(0,r.jsx)(n.td,{children:"$50K"}),(0,r.jsx)(n.td,{children:"\u274c None"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Auth0"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Limited"}),(0,r.jsx)(n.td,{children:"\u274c API only"}),(0,r.jsx)(n.td,{children:"$180K"}),(0,r.jsx)(n.td,{children:"\u2705 High"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AWS Cognito"}),(0,r.jsx)(n.td,{children:"\u274c AWS only"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Some custom"}),(0,r.jsx)(n.td,{children:"$120K"}),(0,r.jsx)(n.td,{children:"\u2705 Complete"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Azure AD B2C"}),(0,r.jsx)(n.td,{children:"\u274c Azure only"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Some custom"}),(0,r.jsx)(n.td,{children:"$150K"}),(0,r.jsx)(n.td,{children:"\u2705 Complete"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Custom Identity Service"}),(0,r.jsx)(n.td,{children:"\u2705 Full"}),(0,r.jsx)(n.td,{children:"\u2705 Extensive"}),(0,r.jsx)(n.td,{children:"$200K+"}),(0,r.jsx)(n.td,{children:"\u274c None"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decisi\xf3n",children:"Decisi\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["Adoptar ",(0,r.jsx)(n.code,{children:"Keycloak"})," containerizado como proveedor de identidad central con deployment cloud-agnostic usando ",(0,r.jsx)(n.code,{children:"Docker"}),"/",(0,r.jsx)(n.code,{children:"Kubernetes"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"arquitectura-containerizada",children:"Arquitectura containerizada"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Keycloak Container Stack\nversion: '3.8'\nservices:\n  keycloak:\n    image: quay.io/keycloak/keycloak:23.0\n    environment:\n      - KEYCLOAK_ADMIN=admin\n      - KEYCLOAK_ADMIN_PASSWORD=${ADMIN_PASSWORD}\n      - KC_DB=postgres\n      - KC_DB_URL=${DATABASE_URL}\n      - KC_DB_USERNAME=${DB_USERNAME}\n      - KC_DB_PASSWORD=${DB_PASSWORD}\n      - KC_HOSTNAME=${KEYCLOAK_HOSTNAME}\n      - KC_PROXY=edge\n    command:\n      - start\n      - --optimized\n      - --spi-theme-static-max-age=-1\n      - --spi-theme-cache-themes=false\n    ports:\n      - \"8080:8080\"\n    depends_on:\n      - postgres\n    volumes:\n      - ./themes:/opt/keycloak/themes\n      - ./providers:/opt/keycloak/providers\n\n  postgres:\n    image: postgres:15-alpine\n    environment:\n      - POSTGRES_DB=keycloak\n      - POSTGRES_USER=${DB_USERNAME}\n      - POSTGRES_PASSWORD=${DB_PASSWORD}\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\nvolumes:\n  postgres_data:\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuraci\xf3n-multi-tenant-realms",children:"Configuraci\xf3n multi-tenant (realms)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Realm Configuration per Country\nRealms:\n  peru-realm:\n    enabled: true\n    users: 15000\n    external_idp: google-workspace-peru\n    compliance: GDPR, Local Peruvian Regulations\n\n  ecuador-realm:\n    enabled: true\n    users: 8000\n    external_idp: google-workspace-ecuador\n    compliance: GDPR, Local Ecuadorian Regulations\n\n  colombia-realm:\n    enabled: true\n    users: 12000\n    external_idp: microsoft-ad-colombia\n    compliance: GDPR, Local Colombian Regulations\n\n  mexico-realm:\n    enabled: true\n    users: 20000\n    external_idp: google-workspace-mexico\n    compliance: GDPR, Local Mexican Regulations\n"})}),"\n",(0,r.jsx)(n.h3,{id:"justificaci\xf3n",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cloud agnostic: Funciona en cualquier plataforma de contenedores"}),"\n",(0,r.jsx)(n.li,{children:"Zero lock-in: Open source, migrable a cualquier cloud"}),"\n",(0,r.jsx)(n.li,{children:"Protocolos est\xe1ndar: OAuth2, OIDC, SAML"}),"\n",(0,r.jsx)(n.li,{children:"Container-first: Despliegue en Kubernetes, Docker Swarm o ECS"}),"\n",(0,r.jsx)(n.li,{children:"Out-of-the-box features: Todo lo requerido est\xe1 incluido"}),"\n",(0,r.jsx)(n.li,{children:"Configuration-only: Solo archivos YAML y variables de entorno"}),"\n",(0,r.jsx)(n.li,{children:"Theme customization: Branding v\xeda templates, sin c\xf3digo"}),"\n",(0,r.jsx)(n.li,{children:"SPI plugins: Extensiones disponibles sin desarrollo"}),"\n",(0,r.jsx)(n.li,{children:"Infraestructura como c\xf3digo: Despliegues reproducibles"}),"\n",(0,r.jsx)(n.li,{children:"Health checks: Readiness/liveness probes integrados"}),"\n",(0,r.jsx)(n.li,{children:"Monitoring: Endpoint de m\xe9tricas para Prometheus"}),"\n",(0,r.jsx)(n.li,{children:"Backup/restore: Estrategia de respaldo de base de datos"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"consecuencias",children:"Consecuencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Cero desarrollo personalizado"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Portabilidad de nube"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Rentable"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Control completo"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Basado en est\xe1ndares"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Multi-tenancy, federaci\xf3n, auditor\xeda"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Responsabilidad operacional"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Expertise requerido"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Overhead de mantenimiento"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Sin soporte de proveedor (salvo suscripci\xf3n Red Hat)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"adr-002-jwt-con-rs256-como-formato-de-token-est\xe1ndar",children:"ADR-002: JWT con RS256 como formato de token est\xe1ndar"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Valor"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Estado"}),(0,r.jsx)(n.td,{children:"\u2705 Aprobado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fecha"}),(0,r.jsx)(n.td,{children:"2024-01-20"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Decidido por"}),(0,r.jsx)(n.td,{children:"Seguridad, Engineering Lead"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Relacionado"}),(0,r.jsxs)(n.td,{children:["ADR-001 (",(0,r.jsx)(n.code,{children:"Keycloak"}),"), ADR-004 (Token Caching)"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"contexto-1",children:"Contexto"}),"\n",(0,r.jsx)(n.p,{children:"Los microservicios requieren un mecanismo de autenticaci\xf3n/autorizaci\xf3n que sea:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Stateless: Sin dependencia en session storage"}),"\n",(0,r.jsx)(n.li,{children:"Performant: Validaci\xf3n r\xe1pida sin round-trips"}),"\n",(0,r.jsx)(n.li,{children:"Secure: Integridad y no repudio"}),"\n",(0,r.jsx)(n.li,{children:"Standard: Amplio soporte en librer\xedas"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternativas-consideradas-1",children:"Alternativas consideradas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Formato"}),(0,r.jsx)(n.th,{children:"Pros"}),(0,r.jsx)(n.th,{children:"Contras"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"JWT RS256"})}),(0,r.jsx)(n.td,{children:"Stateless, signature verification, standard"}),(0,r.jsx)(n.td,{children:"Larger size, key management"}),(0,r.jsx)(n.td,{children:"\u2705 Seleccionado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Opaque Tokens"}),(0,r.jsx)(n.td,{children:"Small size, easy revocation"}),(0,r.jsx)(n.td,{children:"Requires introspection endpoint"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"JWT HS256"})}),(0,r.jsx)(n.td,{children:"Smaller, symmetric"}),(0,r.jsx)(n.td,{children:"Shared secret distribution"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PASETO"}),(0,r.jsx)(n.td,{children:"Modern, secure by default"}),(0,r.jsx)(n.td,{children:"Limited library support"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decisi\xf3n-1",children:"Decisi\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["Utilizar ",(0,r.jsx)(n.code,{children:"JWT"})," (JSON Web Tokens) con algoritmo de firma RS256 para todos los access tokens."]}),"\n",(0,r.jsx)(n.h3,{id:"justificaci\xf3n-1",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Firmas asim\xe9tricas: Verificaci\xf3n de clave p\xfablica, firma de clave privada"}),"\n",(0,r.jsx)(n.li,{children:"No repudio: Prueba criptogr\xe1fica de autenticidad del token"}),"\n",(0,r.jsx)(n.li,{children:"Sin secretos compartidos: Elimina problemas de distribuci\xf3n de secretos"}),"\n",(0,r.jsx)(n.li,{children:"Cumplimiento de est\xe1ndares: RFC 7519, mejores pr\xe1cticas de la industria"}),"\n",(0,r.jsx)(n.li,{children:"Validaci\xf3n sin estado: No se requiere b\xfasqueda en base de datos"}),"\n",(0,r.jsx)(n.li,{children:"Verificaci\xf3n local: Cada servicio valida independientemente"}),"\n",(0,r.jsx)(n.li,{children:"Amigable con cach\xe9: Claves p\xfablicas cacheadas con TTL largo"}),"\n",(0,r.jsx)(n.li,{children:"Herramientas est\xe1ndar: Amplio soporte de bibliotecas (.NET, Java, Node.js)"}),"\n",(0,r.jsx)(n.li,{children:"Amigable para debugging: Payload legible para humanos"}),"\n",(0,r.jsx)(n.li,{children:"Basado en claims: Contexto rico en payload del token"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"token-structure",children:"Token structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "header": {\n    "alg": "RS256",\n    "typ": "JWT",\n    "kid": "realm-key-id"\n  },\n  "payload": {\n    "iss": "https://identity.talma.pe/auth/realms/peru",\n    "sub": "user-uuid",\n    "aud": ["notification-api", "track-trace-api"],\n    "exp": 1640995200,\n    "iat": 1640991600,\n    "jti": "token-uuid",\n    "tenant": "peru",\n    "roles": ["employee", "notification-user"],\n    "scope": "openid profile email",\n    "department": "IT",\n    "country": "PE"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"key-management-strategy",children:"Key management strategy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"Key Rotation Policy:\n  Primary Key:\n    - Lifetime: 90 days\n    - Algorithm: RSA-2048\n    - Auto-rotation: Yes\n\n  Secondary Key:\n    - Lifetime: 30 days overlap\n    - Purpose: Validation during rotation\n\n  Emergency Key:\n    - Purpose: Security incident response\n    - Manual activation only\n"})}),"\n",(0,r.jsx)(n.h3,{id:"consecuencias-1",children:"Consecuencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Alto rendimiento"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Escalabilidad"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Seguridad"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Experiencia del desarrollador"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Tama\xf1o de token"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Complejidad de revocaci\xf3n"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Gesti\xf3n de claves"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"adr-003-multi-realm-strategy-para-aislamiento-multi-tenant",children:"ADR-003: Multi-realm strategy para aislamiento multi-tenant"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Valor"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Estado"}),(0,r.jsx)(n.td,{children:"\u2705 Aprobado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fecha"}),(0,r.jsx)(n.td,{children:"2024-02-01"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Decidido por"}),(0,r.jsx)(n.td,{children:"Product Team, Compliance Officer"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Impacto"}),(0,r.jsx)(n.td,{children:"Alto - Afecta todas las operaciones de tenant"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"contexto-2",children:"Contexto"}),"\n",(0,r.jsx)(n.p,{children:"La organizaci\xf3n opera en 4 pa\xedses con requisitos espec\xedficos:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data residency: Regulaciones locales de protecci\xf3n de datos"}),"\n",(0,r.jsx)(n.li,{children:"Custom branding: Identidad visual por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Different integrations: LDAP/AD espec\xedficos por regi\xf3n"}),"\n",(0,r.jsx)(n.li,{children:"Isolated user management: Administradores locales por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Compliance: Auditor\xedas independientes por jurisdicci\xf3n"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternativas-consideradas-2",children:"Alternativas consideradas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Estrategia"}),(0,r.jsx)(n.th,{children:"Isolation Level"}),(0,r.jsx)(n.th,{children:"Pros"}),(0,r.jsx)(n.th,{children:"Contras"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Single Realm + Groups"}),(0,r.jsx)(n.td,{children:"Logical"}),(0,r.jsx)(n.td,{children:"Simple management"}),(0,r.jsx)(n.td,{children:"Limited isolation"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Multiple Realms"}),(0,r.jsx)(n.td,{children:"Complete"}),(0,r.jsx)(n.td,{children:"Full isolation"}),(0,r.jsx)(n.td,{children:"Complex operations"}),(0,r.jsx)(n.td,{children:"\u2705 Seleccionado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Separate Keycloak Instances"}),(0,r.jsx)(n.td,{children:"Physical"}),(0,r.jsx)(n.td,{children:"Ultimate isolation"}),(0,r.jsx)(n.td,{children:"High operational cost"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Hybrid (Master + Country realms)"}),(0,r.jsx)(n.td,{children:"Mixed"}),(0,r.jsx)(n.td,{children:"Balanced approach"}),(0,r.jsx)(n.td,{children:"Complex design"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decisi\xf3n-2",children:"Decisi\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["Implementar un ",(0,r.jsx)(n.code,{children:"realm"})," ",(0,r.jsx)(n.code,{children:"Keycloak"})," separado por tenant/pa\xeds con configuraci\xf3n independiente."]}),"\n",(0,r.jsx)(n.h3,{id:"arquitectura-de-realms",children:"Arquitectura de realms"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'Keycloak Realm Structure:\n  master:\n    purpose: "Administrative realm only"\n    users: "System administrators"\n    access: "Super-admin operations"\n\n  peru-realm:\n    display_name: "Talma Per\xfa"\n    users: 2000\n    integrations: ["peru-ad.talma.pe", "Google Workspace @talma.pe"]\n    locale: "es-PE"\n    currency: "PEN"\n\n  ecuador-realm:\n    display_name: "Talma Ecuador"\n    users: 800\n    integrations: ["ecuador-ad.talma.ec"]\n    locale: "es-EC"\n    currency: "USD"\n\n  colombia-realm:\n    display_name: "Talma Colombia"\n    users: 1500\n    integrations: ["colombia-ad.talma.co"]\n    locale: "es-CO"\n    currency: "COP"\n\n  mexico-realm:\n    display_name: "Talma M\xe9xico"\n    users: 1200\n    integrations: ["mexico-ad.talma.mx"]\n    locale: "es-MX"\n    currency: "MXN"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"tenant-resolution-strategy",children:"Tenant resolution strategy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class TenantResolver\n{\n    public string ResolveTenant(HttpContext context)\n    {\n        // Priority: JWT claim > Header > Subdomain > Default\n        var jwtTenant = context.User?.FindFirst("tenant")?.Value;\n        if (!string.IsNullOrEmpty(jwtTenant)) return jwtTenant;\n\n        var headerTenant = context.Request.Headers["X-Tenant-ID"].FirstOrDefault();\n        if (!string.IsNullOrEmpty(headerTenant)) return headerTenant;\n\n        var host = context.Request.Host.Host;\n        if (host.StartsWith("peru.")) return "peru";\n        if (host.StartsWith("ecuador.")) return "ecuador";\n        if (host.StartsWith("colombia.")) return "colombia";\n\n        if (host.StartsWith("mexico.")) return "mexico";\n\n        return "default";\n    }\n}\n\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"justificaci\xf3n-2",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data residency: Aislamiento completo de datos por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Audit trails: Logs independientes por jurisdicci\xf3n"}),"\n",(0,r.jsx)(n.li,{children:"Administraci\xf3n local: Privilegios de admin por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Regulatory compliance: GDPR, leyes locales"}),"\n",(0,r.jsx)(n.li,{children:"Configuraci\xf3n independiente: Pol\xedticas de autenticaci\xf3n separadas"}),"\n",(0,r.jsx)(n.li,{children:"Custom branding: Temas y localizaci\xf3n por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Isolated failures: Problemas en un realm no afectan otros"}),"\n",(0,r.jsx)(n.li,{children:"Escalabilidad: Administradores dedicados por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Blast radius limitation: Incidentes de seguridad contenidos por realm"}),"\n",(0,r.jsx)(n.li,{children:"Credenciales independientes: Sin compartici\xf3n entre tenants"}),"\n",(0,r.jsx)(n.li,{children:"Certificados separados: SSL por pa\xeds"}),"\n",(0,r.jsx)(n.li,{children:"Integraciones aisladas: LDAP/AD por pa\xeds"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"consecuencias-2",children:"Consecuencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Aislamiento perfecto"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Cumplimiento regulatorio"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Personalizaci\xf3n por tenant"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Escalabilidad lineal"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Complejidad operativa"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Overhead de recursos"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Consultas cross-tenant complejas"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Riesgo de drift de configuraci\xf3n"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"adr-004-redis-cluster-para-token-validation-caching",children:"ADR-004: Redis cluster para token validation caching"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Valor"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Estado"}),(0,r.jsx)(n.td,{children:"\u2705 Aprobado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fecha"}),(0,r.jsx)(n.td,{children:"2024-02-10"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Decidido por"}),(0,r.jsx)(n.td,{children:"Performance Team, Site Reliability"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Relacionado"}),(0,r.jsxs)(n.td,{children:["ADR-002 (",(0,r.jsx)(n.code,{children:"JWT"})," Tokens)"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"contexto-3",children:"Contexto"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JWT validation: 45-60ms por token (RSA signature verification)"}),"\n",(0,r.jsxs)(n.li,{children:["Target latency: ",(0,r.jsx)(n.code,{children:"<10ms"})," para validaci\xf3n"]}),"\n",(0,r.jsx)(n.li,{children:"Peak load: 10,000 validaciones/segundo"}),"\n",(0,r.jsx)(n.li,{children:"Disponibilidad: 99.9% uptime"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"problema",children:"Problema"}),"\n",(0,r.jsx)(n.p,{children:"Sin caching:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CPU intensive: RSA signature verification"}),"\n",(0,r.jsx)(n.li,{children:"Network latency: JWKS endpoint calls"}),"\n",(0,r.jsx)(n.li,{children:"Scalability issue: Degradaci\xf3n lineal con carga"}),"\n",(0,r.jsx)(n.li,{children:"Cost impact: Mayor consumo de c\xf3mputo"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternativas-consideradas-3",children:"Alternativas consideradas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Soluci\xf3n"}),(0,r.jsx)(n.th,{children:"Pros"}),(0,r.jsx)(n.th,{children:"Contras"}),(0,r.jsx)(n.th,{children:"Performance"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"No caching"}),(0,r.jsx)(n.td,{children:"Simple"}),(0,r.jsx)(n.td,{children:"Poor performance"}),(0,r.jsx)(n.td,{children:"60ms"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"In-memory cache"}),(0,r.jsx)(n.td,{children:"Fast"}),(0,r.jsx)(n.td,{children:"No sharing across instances"}),(0,r.jsx)(n.td,{children:"5ms"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Redis single"}),(0,r.jsx)(n.td,{children:"Distributed"}),(0,r.jsx)(n.td,{children:"Single point of failure"}),(0,r.jsx)(n.td,{children:"8ms"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Redis Cluster"}),(0,r.jsx)(n.td,{children:"HA + distributed"}),(0,r.jsx)(n.td,{children:"Complex setup"}),(0,r.jsx)(n.td,{children:"7ms"}),(0,r.jsx)(n.td,{children:"\u2705 Seleccionado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"DynamoDB"}),(0,r.jsx)(n.td,{children:"Managed"}),(0,r.jsx)(n.td,{children:"Higher latency"}),(0,r.jsx)(n.td,{children:"15ms"}),(0,r.jsx)(n.td,{children:"\u274c Rechazado"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decisi\xf3n-3",children:"Decisi\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["Implementar ",(0,r.jsx)(n.code,{children:"Redis Cluster"})," para caching distribuido de metadatos de validaci\xf3n de tokens."]}),"\n",(0,r.jsx)(n.h3,{id:"cache-strategy",children:"Cache strategy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"Caching Layers:\n  L1_Local_Memory:\n    - Technology: .NET MemoryCache\n    - TTL: 5 minutes\n    - Size: 100MB per instance\n    - Purpose: Hot token validation\n\n  L2_Distributed_Redis:\n    - Technology: Redis Cluster (3 masters, 3 replicas)\n    - TTL: Token expiration time\n    - Size: 2GB total\n    - Purpose: Cross-instance sharing\n\nCache Keys:\n  - jwt_signature:{token_hash} -> validation_result\n  - jwks_keys:{realm}:{kid} -> public_key\n  - user_context:{user_id} -> enriched_claims\n"})}),"\n",(0,r.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class TokenValidationCache\n{\n    private readonly IMemoryCache _localCache;\n    private readonly IDistributedCache _distributedCache;\n\n    public async Task<ValidationResult> GetValidationResultAsync(string tokenHash)\n    {\n        // L1 Cache\n        if (_localCache.TryGetValue($"jwt:{tokenHash}", out ValidationResult localResult))\n        {\n            return localResult;\n        }\n\n        // L2 Cache\n        var serializedResult = await _distributedCache.GetStringAsync($"jwt:{tokenHash}");\n        if (serializedResult != null)\n        {\n            var distributedResult = JsonSerializer.Deserialize<ValidationResult>(serializedResult);\n\n            // Populate L1\n            _localCache.Set($"jwt:{tokenHash}", distributedResult, TimeSpan.FromMinutes(5));\n\n            return distributedResult;\n        }\n\n        return null; // Cache miss\n    }\n\n    public async Task SetValidationResultAsync(string tokenHash, ValidationResult result, TimeSpan ttl)\n    {\n        var serialized = JsonSerializer.Serialize(result);\n\n        // Set in both caches\n        await _distributedCache.SetStringAsync($"jwt:{tokenHash}", serialized, new DistributedCacheEntryOptions\n        {\n            AbsoluteExpirationRelativeToNow = ttl\n        });\n\n        _localCache.Set($"jwt:{tokenHash}", result, TimeSpan.FromMinutes(5));\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"infrastructure-configuration",children:"Infrastructure configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'Redis Cluster:\n  Masters: 3\n\n  Replicas: 3\n  Instance_Type: cache.r6g.large\n  Memory: 12.93 GB per node\n\n  Configuration:\n    maxmemory-policy: allkeys-lru\n\n    tcp-keepalive: 60\n    timeout: 300\n\n  Backup:\n    automatic_backup: true\n    backup_retention: 5 days\n\n    backup_window: "03:00-05:00"\n\n\n  Monitoring:\n    cloudwatch_metrics: enabled\n    slowlog_enabled: true\n    cpu_threshold: 80%\n\n\n    memory_threshold: 85%\n'})}),"\n",(0,r.jsx)(n.h3,{id:"justificaci\xf3n-3",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Latency improvement: 60ms \u2192 7ms (88% reducci\xf3n)"}),"\n",(0,r.jsx)(n.li,{children:"Capacidad de procesamiento: 10x m\xe1s req/sec"}),"\n",(0,r.jsx)(n.li,{children:"CPU savings: 70% menos uso en validaci\xf3n"}),"\n",(0,r.jsx)(n.li,{children:"Cost optimization: Instancias m\xe1s peque\xf1as"}),"\n",(0,r.jsx)(n.li,{children:"Alta disponibilidad: Redis Cluster automatic failover"}),"\n",(0,r.jsx)(n.li,{children:"Persistencia: AOF + RDB backups"}),"\n",(0,r.jsx)(n.li,{children:"Graceful degradation: Fallback a validaci\xf3n directa"}),"\n",(0,r.jsx)(n.li,{children:"Monitoring: CloudWatch metrics"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"consecuencias-3",children:"Consecuencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Mejora dram\xe1tica de performance"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Optimizaci\xf3n de costos"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Escalabilidad"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Alta disponibilidad"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Complejidad adicional"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Overhead operativo"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Riesgo de dependencia"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Costos de memoria"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"adr-005-event-sourcing-para-audit-trail-compliance",children:"ADR-005: Event sourcing para audit trail compliance"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Campo"}),(0,r.jsx)(n.th,{children:"Valor"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Estado"}),(0,r.jsx)(n.td,{children:"\u2705 Aprobado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Fecha"}),(0,r.jsx)(n.td,{children:"2024-02-15"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Decidido por"}),(0,r.jsx)(n.td,{children:"Compliance Officer, Data Architect"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Regulatory"}),(0,r.jsx)(n.td,{children:"GDPR, SOX, ISO 27001"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"contexto-4",children:"Contexto"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Audit trail completo: Todas las operaciones de identidad deben ser registradas"}),"\n",(0,r.jsx)(n.li,{children:"Registros inmutables: No pueden ser modificados"}),"\n",(0,r.jsx)(n.li,{children:"Retenci\xf3n a largo plazo: 7 a\xf1os para compliance financiero"}),"\n",(0,r.jsx)(n.li,{children:"Monitoreo en tiempo real: Detecci\xf3n inmediata de eventos de seguridad"}),"\n",(0,r.jsx)(n.li,{children:"Forensic analysis: Capacidad de investigaci\xf3n detallada"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"alternativas-consideradas-4",children:"Alternativas consideradas"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspecto"}),(0,r.jsx)(n.th,{children:"Logging Tradicional"}),(0,r.jsx)(n.th,{children:"Event Sourcing"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Inmutabilidad"}),(0,r.jsx)(n.td,{children:"Archivos modificables"}),(0,r.jsx)(n.td,{children:"Eventos inmutables"}),(0,r.jsx)(n.td,{children:"\u2705 Event Sourcing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Completitud"}),(0,r.jsx)(n.td,{children:"Limitado a lo logueado"}),(0,r.jsx)(n.td,{children:"Cambios completos"}),(0,r.jsx)(n.td,{children:"\u2705 Event Sourcing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Time travel"}),(0,r.jsx)(n.td,{children:"No posible"}),(0,r.jsx)(n.td,{children:"Full history replay"}),(0,r.jsx)(n.td,{children:"\u2705 Event Sourcing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Compliance"}),(0,r.jsx)(n.td,{children:"B\xe1sico"}),(0,r.jsx)(n.td,{children:"Auditabilidad total"}),(0,r.jsx)(n.td,{children:"\u2705 Event Sourcing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Complejidad"}),(0,r.jsx)(n.td,{children:"Simple"}),(0,r.jsx)(n.td,{children:"M\xe1s complejo"}),(0,r.jsx)(n.td,{children:"Trade-off aceptable"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"decisi\xf3n-4",children:"Decisi\xf3n"}),"\n",(0,r.jsxs)(n.p,{children:["Implementar ",(0,r.jsx)(n.code,{children:"Event Sourcing"})," para audit trail y compliance reporting."]}),"\n",(0,r.jsx)(n.h3,{id:"event-store-architecture",children:"Event store architecture"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"Event Store:\n  Primary: PostgreSQL with JSONB events\n  Stream: Event Bus agn\xf3stico para procesamiento en tiempo real\n  Archive: AWS S3 for long-term storage\n  Analytics: AWS Athena for querying archived events\n\nEvent Categories:\n  Authentication:\n    - UserLoginAttempted\n    - UserLoggedIn\n    - UserLogoutInitiated\n    - MfaChallengeSent\n    - MfaChallengeCompleted\n\n  Authorization:\n    - PermissionGranted\n    - PermissionDenied\n    - RoleAssigned\n    - RoleRevoked\n\n  Administration:\n    - UserCreated\n    - UserModified\n    - UserDeactivated\n    - ConfigurationChanged\n\n  Compliance:\n    - DataExported\n    - DataDeleted\n    - ConsentGranted\n    - ConsentRevoked\n"})}),"\n",(0,r.jsx)(n.h3,{id:"event-schema-design",children:"Event schema design"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public abstract class IdentityEvent\n{\n    public Guid EventId { get; init; } = Guid.NewGuid();\n    public string StreamId { get; init; } // User ID or Admin ID\n    public string EventType { get; init; }\n    public DateTime Timestamp { get; init; } = DateTime.UtcNow;\n    public string TenantId { get; init; }\n    public string UserId { get; init; }\n    public string SessionId { get; init; }\n    public string ClientIP { get; init; }\n    public string UserAgent { get; init; }\n    public object Metadata { get; init; }\n    public object Data { get; init; }\n}\n\n// Specific event example\npublic class UserLoggedInEvent : IdentityEvent\n{\n    public string AuthenticationMethod { get; init; } // password, mfa, federated\n    public bool MfaUsed { get; init; }\n    public TimeSpan LoginDuration { get; init; }\n    public string DeviceFingerprint { get; init; }\n    public GeoLocation Location { get; init; }\n}\n\npublic class RoleAssignedEvent : IdentityEvent\n{\n    public string RoleName { get; init; }\n    public string AssignedByUserId { get; init; }\n    public DateTime? ExpiresAt { get; init; }\n    public string Justification { get; init; }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"event-store-implementation",children:"Event store implementation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class PostgreSQLEventStore : IEventStore\n{\n    private readonly NpgsqlConnection _connection;\n\n    public async Task AppendEventsAsync(string streamId, IEnumerable<IdentityEvent> events)\n    {\n        using var transaction = await _connection.BeginTransactionAsync();\n\n        try\n        {\n            foreach (var @event in events)\n            {\n                await _connection.ExecuteAsync(\n                    @"INSERT INTO event_store (\n                        event_id, stream_id, event_type, event_version,\n                        timestamp, tenant_id, user_id, session_id,\n                        client_ip, user_agent, event_data, metadata\n                    ) VALUES (\n                        @EventId, @StreamId, @EventType, @EventVersion,\n                        @Timestamp, @TenantId, @UserId, @SessionId,\n                        @ClientIP, @UserAgent, @EventData::jsonb, @Metadata::jsonb\n                    )",\n                    new\n                    {\n                        @event.EventId,\n                        StreamId = streamId,\n                        @event.EventType,\n                        EventVersion = GetNextVersion(streamId),\n                        @event.Timestamp,\n                        @event.TenantId,\n                        @event.UserId,\n                        @event.SessionId,\n                        @event.ClientIP,\n                        @event.UserAgent,\n                        EventData = JsonSerializer.Serialize(@event.Data),\n                        Metadata = JsonSerializer.Serialize(@event.Metadata)\n                    });\n            }\n\n            await transaction.CommitAsync();\n        }\n        catch\n        {\n            await transaction.RollbackAsync();\n            throw;\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"real-time-event-processing",children:"Real-time event processing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class SecurityEventProcessor\n{\n    private readonly IKafkaProducer _producer;\n\n    private readonly ISecurityAnalyzer _analyzer;\n\n    public async Task ProcessEventAsync(IdentityEvent @event)\n    {\n        // Immediate security analysis\n        var threatLevel = await _analyzer.AnalyzeThreatLevelAsync(@event);\n\n\n        if (threatLevel >= ThreatLevel.High)\n        {\n            await SendSecurityAlertAsync(@event, threatLevel);\n        }\n\n\n        // Stream to Kafka for downstream processing\n\n        await _producer.ProduceAsync("identity-events", new Message<string, string>\n        {\n            Key = @event.StreamId,\n            Value = JsonSerializer.Serialize(@event)\n\n        });\n\n\n        // Update dashboards en tiempo real\n        await UpdateSecurityDashboardAsync(@event);\n    }\n}\n\n\n'})}),"\n",(0,r.jsx)(n.h3,{id:"justificaci\xf3n-4",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Inmutabilidad: Eventos inmutables para compliance"}),"\n",(0,r.jsx)(n.li,{children:"Completitud: Captura de todos los eventos"}),"\n",(0,r.jsx)(n.li,{children:"Consultas temporales: Reconstrucci\xf3n del estado del sistema en un momento dado"}),"\n",(0,r.jsx)(n.li,{children:"Cumplimiento regulatorio: Satisface requisitos de SOX, GDPR, ISO 27001"}),"\n",(0,r.jsx)(n.li,{children:"An\xe1lisis de seguridad en tiempo real: Detecci\xf3n inmediata de amenazas"}),"\n",(0,r.jsx)(n.li,{children:"Capacidades forenses: L\xednea de tiempo completa del ataque"}),"\n",(0,r.jsx)(n.li,{children:"Monitoreo y an\xe1lisis de rendimiento: Patrones de uso del sistema"}),"\n",(0,r.jsx)(n.li,{children:"Recuperaci\xf3n de datos: Estado reconstruido a partir de eventos"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"consecuencias-4",children:"Consecuencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Cumplimiento total"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Mejora en la seguridad y capacidades forenses"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Fiabilidad y facilidad de debugging"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Costos de almacenamiento"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Complejidad en las consultas"}),"\n",(0,r.jsx)(n.li,{children:"\u274c Overhead en el rendimiento"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"resumen-de-decisiones",children:"Resumen de decisiones"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"ADR"}),(0,r.jsx)(n.th,{children:"Decisi\xf3n"}),(0,r.jsx)(n.th,{children:"Impacto"}),(0,r.jsx)(n.th,{children:"Estado"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-001"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"Keycloak"})," como IdP"]}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"\u2705 Implementado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-002"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"JWT RS256"})," tokens"]}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"\u2705 Implementado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-003"}),(0,r.jsx)(n.td,{children:"Multi-realm multi-tenancy"}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"\u2705 Implementado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-004"}),(0,r.jsx)(n.td,{children:"Redis caching"}),(0,r.jsx)(n.td,{children:"Medio"}),(0,r.jsx)(n.td,{children:"\u2705 Implementado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ADR-005"}),(0,r.jsx)(n.td,{children:"Event sourcing audit"}),(0,r.jsx)(n.td,{children:"Alto"}),(0,r.jsx)(n.td,{children:"\u2705 Implementado"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"referencias",children:"Referencias"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://adr.github.io/",children:"Architecture Decision Records (ADRs)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.keycloak.org/documentation",children:"Keycloak Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc8725",children:"JWT Mejores Pr\xe1cticas"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://martinfowler.com/eaaDev/EventSourcing.html",children:"Event Sourcing Pattern"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://gdpr.eu/compliance/",children:"GDPR Compliance Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.sox-online.com/sox_it_controls.html",children:"SOX IT Controls"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.iso.org/isoiec-27001-information-security.html",children:"ISO 27001 Information Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.arc42.org/section-9/",children:"Arc42 Decisiones de Arquitectura"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);