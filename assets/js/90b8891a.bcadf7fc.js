"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[3809],{5389:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"adrs/adr-019-configuraciones-scripts-bd","title":"Configuraciones por Scripts en BD","description":"\u2705 ESTADO","source":"@site/docs/adrs/adr-019-configuraciones-scripts-bd.md","sourceDirName":"adrs","slug":"/adrs/adr-019-configuraciones-scripts-bd","permalink":"/tlm-doc-architecture/docs/adrs/adr-019-configuraciones-scripts-bd","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/adrs/adr-019-configuraciones-scripts-bd.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Configuraciones por Scripts en BD","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Autenticaci\xf3n Centralizada SSO y Multi-Tenancy","permalink":"/tlm-doc-architecture/docs/adrs/adr-004-autenticacion-sso"},"next":{"title":"Gesti\xf3n de Configuraciones","permalink":"/tlm-doc-architecture/docs/adrs/adr-005-gestion-configuraciones"}}');var r=n(74848),d=n(28453);const t={title:"Configuraciones por Scripts en BD",sidebar_position:4},c=void 0,a={},l=[{value:"\u2705 ESTADO",id:"-estado",level:2},{value:"\ud83d\uddfa\ufe0f CONTEXTO",id:"\ufe0f-contexto",level:2},{value:"\ud83d\udd0d COMPARATIVA DE ALTERNATIVAS",id:"-comparativa-de-alternativas",level:2},{value:"Comparativa Cualitativa",id:"comparativa-cualitativa",level:3},{value:"Matriz de Decisi\xf3n",id:"matriz-de-decisi\xf3n",level:3},{value:"\u2714\ufe0f DECISI\xd3N",id:"\ufe0f-decisi\xf3n",level:2},{value:"Justificaci\xf3n",id:"justificaci\xf3n",level:2},{value:"Alternativas descartadas",id:"alternativas-descartadas",level:2},{value:"\u26a0\ufe0f CONSECUENCIAS",id:"\ufe0f-consecuencias",level:2},{value:"\ud83d\udcda REFERENCIAS",id:"-referencias",level:2}];function o(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.h2,{id:"-estado",children:"\u2705 ESTADO"}),"\n",(0,r.jsx)(i.p,{children:"Aceptada \u2013 Agosto 2025"}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"\ufe0f-contexto",children:"\ud83d\uddfa\ufe0f CONTEXTO"}),"\n",(0,r.jsxs)(i.p,{children:["Algunos microservicios requieren ",(0,r.jsx)(i.strong,{children:"configuraciones iniciales o poco frecuentes"})," directamente en la base de datos, como:"]}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Carga inicial de par\xe1metros de negocio"})," (cat\xe1logos, valores por defecto)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Ajustes estructurales menores"})," que no justifican una migraci\xf3n completa de esquema."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Habilitaci\xf3n/deshabilitaci\xf3n de caracter\xedsticas"})," mediante flags en tablas de configuraci\xf3n."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Correcci\xf3n puntual de datos"})," durante despliegues o mantenimiento."]}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"Dado que estos cambios:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Se realizan al inicio o de forma muy espor\xe1dica."}),"\n",(0,r.jsx)(i.li,{children:"No justifican crear un API o interfaz dedicada."}),"\n",(0,r.jsxs)(i.li,{children:["Deben ser ",(0,r.jsx)(i.strong,{children:"versionados, auditables y reproducibles"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Idealmente deben ser ",(0,r.jsx)(i.strong,{children:"agn\xf3sticos de motor de BD"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["La intenci\xf3n estrat\xe9gica es ",(0,r.jsx)(i.strong,{children:"permitir la ejecuci\xf3n controlada y trazable de scripts"})," integrados al ciclo de despliegue, evitando cambios manuales no registrados."]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-comparativa-de-alternativas",children:"\ud83d\udd0d COMPARATIVA DE ALTERNATIVAS"}),"\n",(0,r.jsx)(i.h3,{id:"comparativa-cualitativa",children:"Comparativa Cualitativa"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Criterio"}),(0,r.jsx)(i.th,{children:"DbUp (.NET)"}),(0,r.jsx)(i.th,{children:"RoundhousE (.NET)"}),(0,r.jsx)(i.th,{children:"Flyway (CLI/Java)"}),(0,r.jsx)(i.th,{children:"Liquibase (CLI/Java)"}),(0,r.jsx)(i.th,{children:"EF Core Migrations"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Agnosticidad"})}),(0,r.jsx)(i.td,{children:"\u2705 Multi-motor"}),(0,r.jsx)(i.td,{children:"\u2705 Multi-motor"}),(0,r.jsx)(i.td,{children:"\u2705 Multi-motor"}),(0,r.jsx)(i.td,{children:"\u2705 Multi-motor"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del provider"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Integraci\xf3n .NET"})}),(0,r.jsx)(i.td,{children:"\u2705 Nativo C#"}),(0,r.jsx)(i.td,{children:"\u2705 Nativo C#"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Indirecta"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Indirecta"}),(0,r.jsx)(i.td,{children:"\u2705 Nativo C#"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Versionado de scripts"})}),(0,r.jsx)(i.td,{children:"\u2705 Por convenci\xf3n"}),(0,r.jsx)(i.td,{children:"\u2705 Por convenci\xf3n"}),(0,r.jsx)(i.td,{children:"\u2705 Estricto"}),(0,r.jsx)(i.td,{children:"\u2705 Estricto"}),(0,r.jsx)(i.td,{children:"\u2705 Autom\xe1tico"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Complejidad operativa"})}),(0,r.jsx)(i.td,{children:"\u2705 Baja"}),(0,r.jsx)(i.td,{children:"\u2705 Baja"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Media"}),(0,r.jsx)(i.td,{children:"\u274c Alta"}),(0,r.jsx)(i.td,{children:"\u2705 Baja"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Rollbacks"})}),(0,r.jsx)(i.td,{children:"\u274c Manuales"}),(0,r.jsx)(i.td,{children:"\u274c Manuales"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 B\xe1sicos"}),(0,r.jsx)(i.td,{children:"\u2705 Avanzados"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Limitados"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Idempotencia"})}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del script"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del script"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del script"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del script"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Depende del script"})]})]})]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h3,{id:"matriz-de-decisi\xf3n",children:"Matriz de Decisi\xf3n"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Soluci\xf3n"}),(0,r.jsx)(i.th,{children:"Agnosticidad"}),(0,r.jsx)(i.th,{children:"Integraci\xf3n .NET"}),(0,r.jsx)(i.th,{children:"Operaci\xf3n"}),(0,r.jsx)(i.th,{children:"Recomendaci\xf3n"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"DbUp"})}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsxs)(i.td,{children:["\u2705 ",(0,r.jsx)(i.strong,{children:"Seleccionada"})]})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"RoundhousE"})}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Alternativa"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Flyway"})}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Media"}),(0,r.jsx)(i.td,{children:"Media"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Alternativa"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"Liquibase"})}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Media"}),(0,r.jsx)(i.td,{children:"Baja"}),(0,r.jsx)(i.td,{children:"\u274c Descartada"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.strong,{children:"EF Core Migrations"})}),(0,r.jsx)(i.td,{children:"Media"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"Excelente"}),(0,r.jsx)(i.td,{children:"\ud83d\udfe1 Uso parcial"})]})]})]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"\ufe0f-decisi\xf3n",children:"\u2714\ufe0f DECISI\xd3N"}),"\n",(0,r.jsxs)(i.p,{children:["Se selecciona ",(0,r.jsx)(i.strong,{children:"DbUp"})," como herramienta principal para la ejecuci\xf3n de configuraciones iniciales y puntuales en base de datos."]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"justificaci\xf3n",children:"Justificaci\xf3n"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Compatibilidad multi-motor"})," (SQL Server, PostgreSQL, MySQL, etc.)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Integraci\xf3n directa con .NET 8"})," sin dependencias externas (Java/CLI)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Baja complejidad operativa"}),": scripts en SQL puro, versionados y aplicados de forma ordenada."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Facilidad de integraci\xf3n en pipelines CI/CD"}),", pudiendo ejecutar en despliegues iniciales o bajo demanda."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Posibilidad de migrar"})," a Flyway/Liquibase en el futuro manteniendo el formato SQL base."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"alternativas-descartadas",children:"Alternativas descartadas"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"RoundhousE"}),": buena opci\xf3n, pero menos activo y con menor comunidad que DbUp."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Flyway"}),": m\xe1s maduro en entornos mixtos, pero introduce dependencia Java y mayor complejidad para este escenario puntual."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Liquibase"}),": potente pero sobre-dimensionado para cambios ocasionales."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"EF Core Migrations"}),": \xfatil para cambios de esquema ligados al modelo de datos, pero no ideal para configuraciones iniciales que puedan ejecutarse en m\xfaltiples motores."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"\ufe0f-consecuencias",children:"\u26a0\ufe0f CONSECUENCIAS"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Los scripts deben ser ",(0,r.jsx)(i.strong,{children:"idempotentes"})," para evitar errores en re-ejecuciones."]}),"\n",(0,r.jsxs)(i.li,{children:["La nomenclatura de archivos (",(0,r.jsx)(i.code,{children:"yyyy.MM.dd__descripcion.sql"}),") debe ser consistente para asegurar orden y trazabilidad."]}),"\n",(0,r.jsx)(i.li,{children:"La responsabilidad de escribir y validar los scripts recae en el equipo t\xe9cnico, no en usuarios finales."}),"\n",(0,r.jsx)(i.li,{children:"No se implementar\xe1 UI ni API dedicada para este tipo de configuraciones."}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"-referencias",children:"\ud83d\udcda REFERENCIAS"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://dbup.readthedocs.io/en/latest/",children:"DbUp Documentation"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://github.com/chucknorris/roundhouse",children:"RoundhousE GitHub"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://documentation.red-gate.com/fd",children:"Flyway Documentation"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://www.liquibase.org/",children:"Liquibase Documentation"})}),"\n",(0,r.jsx)(i.li,{children:(0,r.jsx)(i.a,{href:"https://learn.microsoft.com/en-us/ef/core/managing-schemas/migrations/",children:"EF Core Migrations Docs"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,d.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>c});var s=n(96540);const r={},d=s.createContext(r);function t(e){const i=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(d.Provider,{value:i},e.children)}}}]);