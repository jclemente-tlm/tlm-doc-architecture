"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[3788],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var i=r(96540);const s={},d=i.createContext(s);function t(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(d.Provider,{value:n},e.children)}},86006:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"adrs/adr-015-manejo-errores-cola","title":"Manejo de Errores en Cola","description":"\u2705 ESTADO","source":"@site/docs/adrs/adr-015-manejo-errores-cola.md","sourceDirName":"adrs","slug":"/adrs/adr-015-manejo-errores-cola","permalink":"/docs/adrs/adr-015-manejo-errores-cola","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/adrs/adr-015-manejo-errores-cola.md","tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"title":"Manejo de Errores en Cola","sidebar_position":15},"sidebar":"tutorialSidebar","previous":{"title":"Almacenamiento de Objetos","permalink":"/docs/adrs/adr-014-almacenamiento-objetos"},"next":{"title":"Logging Estructurado","permalink":"/docs/adrs/adr-016-logging-estructurado"}}');var s=r(74848),d=r(28453);const t={title:"Manejo de Errores en Cola",sidebar_position:15},a=void 0,l={},c=[{value:"\u2705 ESTADO",id:"-estado",level:2},{value:"\ud83d\uddfa\ufe0f CONTEXTO",id:"\ufe0f-contexto",level:2},{value:"COMPARATIVA DE ALTERNATIVAS",id:"comparativa-de-alternativas",level:3},{value:"Comparativa Cualitativa",id:"comparativa-cualitativa",level:3},{value:"Matriz de Decisi\xf3n",id:"matriz-de-decisi\xf3n",level:3},{value:"DECISI\xd3N",id:"decisi\xf3n",level:2},{value:"Justificaci\xf3n",id:"justificaci\xf3n",level:2},{value:"Alternativas descartadas",id:"alternativas-descartadas",level:2},{value:"\u26a0\ufe0f CONSECUENCIAS",id:"\ufe0f-consecuencias",level:2},{value:"\ud83d\udcda REFERENCIAS",id:"-referencias",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"-estado",children:"\u2705 ESTADO"}),"\n",(0,s.jsx)(n.p,{children:"Aceptada \u2013 Agosto 2025"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-contexto",children:"\ud83d\uddfa\ufe0f CONTEXTO"}),"\n",(0,s.jsx)(n.p,{children:"Los servicios corporativos distribuidos con mensajer\xeda as\xedncrona requieren una estrategia robusta para manejar:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Mensajes fallidos"})," que no pueden procesarse despu\xe9s de m\xfaltiples reintentos"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Poison messages"})," que causan errores recurrentes en consumidores"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Recuperaci\xf3n de mensajes"})," para reprocesamiento manual o automatizado"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Auditor\xeda de fallos"})," para an\xe1lisis de patrones y mejora continua"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Aislamiento de errores"})," para evitar que mensajes problem\xe1ticos bloqueen colas"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Alertas proactivas"})," cuando se detectan patrones de fallo"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Retenci\xf3n configurable"})," seg\xfan criticidad del mensaje"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compatibilidad multi-tenant"})," con segregaci\xf3n por pa\xeds"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["La intenci\xf3n estrat\xe9gica es ",(0,s.jsx)(n.strong,{children:"balancear resiliencia vs complejidad operacional"})," para sistemas de mensajer\xeda empresarial."]}),"\n",(0,s.jsx)(n.p,{children:"Las alternativas evaluadas fueron:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dead Letter Queue (DLQ)"})," con Apache Kafka, AWS SQS, Azure Service Bus"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reintentos exponenciales"})," sin DLQ"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Circuit Breaker"})," con bypass temporal"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Manual retry"})," con almacenamiento persistente"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Event Store"})," con replay capability"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hybrid approach"})," (DLQ + Circuit Breaker)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"comparativa-de-alternativas",children:"COMPARATIVA DE ALTERNATIVAS"}),"\n",(0,s.jsx)(n.h3,{id:"comparativa-cualitativa",children:"Comparativa Cualitativa"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Criterio"}),(0,s.jsx)(n.th,{children:"DLQ"}),(0,s.jsx)(n.th,{children:"Reintentos"}),(0,s.jsx)(n.th,{children:"Circuit Breaker"}),(0,s.jsx)(n.th,{children:"Manual Retry"}),(0,s.jsx)(n.th,{children:"Event Store"}),(0,s.jsx)(n.th,{children:"Hybrid"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Resiliencia"})}),(0,s.jsx)(n.td,{children:"\u2705 Recuperaci\xf3n completa"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 B\xe1sica, puede perder"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Protecci\xf3n temporal"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Depende intervenci\xf3n"}),(0,s.jsx)(n.td,{children:"\u2705 Replay completo"}),(0,s.jsx)(n.td,{children:"\u2705 M\xe1xima protecci\xf3n"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Observabilidad"})}),(0,s.jsx)(n.td,{children:"\u2705 Mensajes visibles"}),(0,s.jsx)(n.td,{children:"\u274c Muy limitada"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 M\xe9tricas b\xe1sicas"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Logs manuales"}),(0,s.jsx)(n.td,{children:"\u2705 Historial completo"}),(0,s.jsx)(n.td,{children:"\u2705 Visibilidad total"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Operaci\xf3n"})}),(0,s.jsx)(n.td,{children:"\u2705 Automatizada"}),(0,s.jsx)(n.td,{children:"\u2705 Muy simple"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Configuraci\xf3n compleja"}),(0,s.jsx)(n.td,{children:"\u274c Intervenci\xf3n manual"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Compleja gesti\xf3n"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Moderadamente compleja"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Agnosticidad"})}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Depende del broker"}),(0,s.jsx)(n.td,{children:"\u2705 Totalmente agn\xf3stico"}),(0,s.jsx)(n.td,{children:"\u2705 Patr\xf3n universal"}),(0,s.jsx)(n.td,{children:"\u2705 Totalmente agn\xf3stico"}),(0,s.jsx)(n.td,{children:"\u2705 Agn\xf3stico"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Depende componentes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Prevenci\xf3n P\xe9rdida"})}),(0,s.jsx)(n.td,{children:"\u2705 Cero p\xe9rdida"}),(0,s.jsx)(n.td,{children:"\u274c Alta probabilidad"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Puede perder durante corte"}),(0,s.jsx)(n.td,{children:"\u2705 Persistencia manual"}),(0,s.jsx)(n.td,{children:"\u2705 Cero p\xe9rdida"}),(0,s.jsx)(n.td,{children:"\u2705 Cero p\xe9rdida"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Automatizaci\xf3n"})}),(0,s.jsx)(n.td,{children:"\u2705 Totalmente autom\xe1tica"}),(0,s.jsx)(n.td,{children:"\u2705 Autom\xe1tica"}),(0,s.jsx)(n.td,{children:"\u2705 Autom\xe1tica"}),(0,s.jsx)(n.td,{children:"\u274c Requiere intervenci\xf3n"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Semi-autom\xe1tica"}),(0,s.jsx)(n.td,{children:"\u2705 Autom\xe1tica"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Costos"})}),(0,s.jsx)(n.td,{children:"\u2705 Moderados"}),(0,s.jsx)(n.td,{children:"\u2705 M\xednimos"}),(0,s.jsx)(n.td,{children:"\u2705 Moderados"}),(0,s.jsx)(n.td,{children:"\u2705 Bajos"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Altos"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Moderados-altos"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"matriz-de-decisi\xf3n",children:"Matriz de Decisi\xf3n"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Soluci\xf3n"}),(0,s.jsx)(n.th,{children:"Resiliencia"}),(0,s.jsx)(n.th,{children:"Observabilidad"}),(0,s.jsx)(n.th,{children:"Operaci\xf3n"}),(0,s.jsx)(n.th,{children:"Prevenci\xf3n P\xe9rdida"}),(0,s.jsx)(n.th,{children:"Recomendaci\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Hybrid (DLQ + Circuit Breaker)"})}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Moderada"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsxs)(n.td,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Seleccionada"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Dead Letter Queue"})}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Autom\xe1tica"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Alternativa"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Event Store"})}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"Compleja"}),(0,s.jsx)(n.td,{children:"Excelente"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Considerada"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Circuit Breaker"})}),(0,s.jsx)(n.td,{children:"Moderada"}),(0,s.jsx)(n.td,{children:"B\xe1sica"}),(0,s.jsx)(n.td,{children:"Compleja"}),(0,s.jsx)(n.td,{children:"Moderada"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Complementaria"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Manual Retry"})}),(0,s.jsx)(n.td,{children:"Moderada"}),(0,s.jsx)(n.td,{children:"Limitada"}),(0,s.jsx)(n.td,{children:"Manual"}),(0,s.jsx)(n.td,{children:"Buena"}),(0,s.jsx)(n.td,{children:"\u274c Descartada"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reintentos sin DLQ"})}),(0,s.jsx)(n.td,{children:"B\xe1sica"}),(0,s.jsx)(n.td,{children:"Muy limitada"}),(0,s.jsx)(n.td,{children:"Simple"}),(0,s.jsx)(n.td,{children:"Mala"}),(0,s.jsx)(n.td,{children:"\u274c Descartada"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"decisi\xf3n",children:"DECISI\xd3N"}),"\n",(0,s.jsxs)(n.p,{children:["Se implementar\xe1n ",(0,s.jsx)(n.code,{children:"Dead Letter Queues (DLQ)"})," en las ",(0,s.jsx)(n.code,{children:"colas SQS"})," utilizadas por los ",(0,s.jsx)(n.code,{children:"microservicios"})," y sistemas que requieran resiliencia en el procesamiento de mensajes."]}),"\n",(0,s.jsx)(n.h2,{id:"justificaci\xf3n",children:"Justificaci\xf3n"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Permite aislar y analizar mensajes que no pudieron procesarse."}),"\n",(0,s.jsx)(n.li,{children:"Facilita la recuperaci\xf3n y reprocesamiento manual o automatizado."}),"\n",(0,s.jsx)(n.li,{children:"Mejora la trazabilidad y auditor\xeda de errores."}),"\n",(0,s.jsxs)(n.li,{children:["Integraci\xf3n nativa con ",(0,s.jsx)(n.code,{children:"AWS SQS"})," y ",(0,s.jsx)(n.code,{children:"CloudWatch"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Reduce el riesgo de p\xe9rdida de informaci\xf3n."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"alternativas-descartadas",children:"Alternativas descartadas"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reintentos sin DLQ"}),": Mayor riesgo de p\xe9rdida de mensajes y menor trazabilidad."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-consecuencias",children:"\u26a0\ufe0f CONSECUENCIAS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Los mensajes fallidos se almacenan en DLQ para an\xe1lisis y recuperaci\xf3n."}),"\n",(0,s.jsx)(n.li,{children:"Se deben definir pol\xedticas de reprocesamiento y monitoreo."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-referencias",children:"\ud83d\udcda REFERENCIAS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-dead-letter-queues.html",children:"AWS SQS DLQ"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://arc42.org/decision/",children:"Arc42: Decisiones de arquitectura"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);