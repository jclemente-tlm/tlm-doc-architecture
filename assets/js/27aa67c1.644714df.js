"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[7681],{12686:(e,n,d)=>{d.d(n,{A:()=>s});const s=d.p+"assets/images/track_and_trace_tracking_ingest_api-3b5ccd1fc71c0bca370f1c94ccadac91.png"},28453:(e,n,d)=>{d.d(n,{R:()=>r,x:()=>c});var s=d(96540);const i={},t=s.createContext(i);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},29642:(e,n,d)=>{d.d(n,{A:()=>s});const s=d.p+"assets/images/track_and_trace_tracking_query_api-2a06aa94f1cefbcf023d4670f3056226.png"},67332:(e,n,d)=>{d.d(n,{A:()=>s});const s=d.p+"assets/images/track_and_trace_event_processor-693e5078df6bce0a4ac825dee5be2be5.png"},68757:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"servicios-corporativos/servicio-track-trace/vista-bloques-construccion","title":"5. Vista de bloques de construcci\xf3n","description":"Esta secci\xf3n describe la estructura modular del sistema Track & Trace, presentando los bloques principales (contenedores y componentes), sus responsabilidades y tecnolog\xedas, as\xed como los principales esquemas de datos y contratos de integraci\xf3n. La visi\xf3n se centra en los elementos implementados y sus relaciones clave para la trazabilidad operacional multi-tenant.","source":"@site/docs/servicios-corporativos/servicio-track-trace/05-vista-bloques-construccion.md","sourceDirName":"servicios-corporativos/servicio-track-trace","slug":"/servicios-corporativos/servicio-track-trace/vista-bloques-construccion","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-track-trace/vista-bloques-construccion","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-track-trace/05-vista-bloques-construccion.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"4. Estrategia de soluci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-track-trace/estrategia-solucion"},"next":{"title":"6. Vista de tiempo de ejecuci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-track-trace/vista-tiempo-ejecucion"}}');var i=d(74848),t=d(28453);const r={},c="5. Vista de bloques de construcci\xf3n",a={},l=[{value:"5.1 Contenedores principales",id:"51-contenedores-principales",level:2},{value:"5.2 Componentes principales",id:"52-componentes-principales",level:2},{value:"Tracking Ingest API",id:"tracking-ingest-api",level:3},{value:"Tracking Query API",id:"tracking-query-api",level:3},{value:"Tracking Event Processor",id:"tracking-event-processor",level:3},{value:"5.3 Esquemas de datos",id:"53-esquemas-de-datos",level:2},{value:"Tabla: <code>tenant_tracking_settings</code>",id:"tabla-tenant_tracking_settings",level:3},{value:"Tabla: event_store",id:"tabla-event_store",level:3},{value:"Tabla: trace_views",id:"tabla-trace_views",level:3},{value:"Ejemplo de contenido y actualizaci\xf3n de trace view para trazabilidad",id:"ejemplo-de-contenido-y-actualizaci\xf3n-de-trace-view-para-trazabilidad",level:4},{value:"5.4 Endpoints principales",id:"54-endpoints-principales",level:2},{value:"Endpoints de Tracking Ingest API",id:"endpoints-de-tracking-ingest-api",level:3},{value:"Endpoints de Tracking Query API",id:"endpoints-de-tracking-query-api",level:3},{value:"5.5 Contratos de entrada y salida",id:"55-contratos-de-entrada-y-salida",level:2},{value:"Contrato de entrada: EventRequest (Tracking Ingest API)",id:"contrato-de-entrada-eventrequest-tracking-ingest-api",level:3},{value:"Contrato de salida: TraceResponse (Tracking Query API)",id:"contrato-de-salida-traceresponse-tracking-query-api",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"5-vista-de-bloques-de-construcci\xf3n",children:"5. Vista de bloques de construcci\xf3n"})}),"\n",(0,i.jsxs)(n.p,{children:["Esta secci\xf3n describe la estructura modular del sistema ",(0,i.jsx)(n.strong,{children:"Track & Trace"}),", presentando los bloques principales (contenedores y componentes), sus responsabilidades y tecnolog\xedas, as\xed como los principales esquemas de datos y contratos de integraci\xf3n. La visi\xf3n se centra en los elementos implementados y sus relaciones clave para la trazabilidad operacional multi-tenant."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Vista General del Sistema Track &amp; Trace",src:d(86058).A+"",width:"5528",height:"2790"})}),"\n",(0,i.jsx)(n.h2,{id:"51-contenedores-principales",children:"5.1 Contenedores principales"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Contenedor"}),(0,i.jsx)(n.th,{children:"Responsabilidad"}),(0,i.jsx)(n.th,{children:"Tecnolog\xeda"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Ingest API"}),(0,i.jsx)(n.td,{children:"API REST para ingesta y validaci\xf3n de eventos"}),(0,i.jsx)(n.td,{children:"C#, ASP.NET Core, REST API"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Query API"}),(0,i.jsx)(n.td,{children:"API REST para consultas de tracking"}),(0,i.jsx)(n.td,{children:"C#, ASP.NET Core, REST API"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Queue"}),(0,i.jsx)(n.td,{children:"Cola para desacoplar ingesta y procesamiento as\xedncrono"}),(0,i.jsx)(n.td,{children:"AWS SQS"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Processor"}),(0,i.jsx)(n.td,{children:"Procesamiento, validaci\xf3n y enriquecimiento de eventos"}),(0,i.jsx)(n.td,{children:"C#, ASP.NET Core, AWS SDK (SQS)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Web"}),(0,i.jsx)(n.td,{children:"Visualizaci\xf3n en tiempo real y an\xe1lisis de eventos"}),(0,i.jsx)(n.td,{children:"React, TypeScript"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Database"}),(0,i.jsx)(n.td,{children:"Almacenamiento de eventos, estados y configuraciones"}),(0,i.jsx)(n.td,{children:"PostgreSQL"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"52-componentes-principales",children:"5.2 Componentes principales"}),"\n",(0,i.jsx)(n.h3,{id:"tracking-ingest-api",children:"Tracking Ingest API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Componentes Tracking Ingest API",src:d(12686).A+"",width:"5330",height:"3195"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Componente"}),(0,i.jsx)(n.th,{children:"Funci\xf3n"}),(0,i.jsx)(n.th,{children:"Tecnolog\xeda"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Controller"}),(0,i.jsx)(n.td,{children:"Endpoints REST para recepci\xf3n masiva de eventos"}),(0,i.jsx)(n.td,{children:"ASP.NET Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Service"}),(0,i.jsx)(n.td,{children:"Procesa y valida eventos, reglas de negocio"}),(0,i.jsx)(n.td,{children:"C#"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Publisher"}),(0,i.jsx)(n.td,{children:"Publica eventos validados en la cola SQS"}),(0,i.jsx)(n.td,{children:"C#, AWS SDK (SQS)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"TenantSettings Repository"}),(0,i.jsx)(n.td,{children:"Gestiona configuraciones por tenant"}),(0,i.jsx)(n.td,{children:"C#, .NET 8, EF Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SecretsAndConfigs"}),(0,i.jsx)(n.td,{children:"Acceso centralizado a configuraciones y secretos"}),(0,i.jsx)(n.td,{children:"AWS Secrets Manager, AppConfig"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Observability"}),(0,i.jsx)(n.td,{children:"Logging, m\xe9tricas, health checks"}),(0,i.jsx)(n.td,{children:"Serilog, Prometheus, HealthChecks"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"tracking-query-api",children:"Tracking Query API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Componentes Tracking Query API",src:d(29642).A+"",width:"5210",height:"2595"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Componente"}),(0,i.jsx)(n.th,{children:"Funci\xf3n"}),(0,i.jsx)(n.th,{children:"Tecnolog\xeda"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Query Controller"}),(0,i.jsx)(n.td,{children:"Endpoints REST para consultas de trazabilidad"}),(0,i.jsx)(n.td,{children:"ASP.NET Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Query Service"}),(0,i.jsx)(n.td,{children:"Orquesta consultas y l\xf3gica de negocio"}),(0,i.jsx)(n.td,{children:"C#"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Data Repository"}),(0,i.jsx)(n.td,{children:"Acceso optimizado a datos de tracking"}),(0,i.jsx)(n.td,{children:"C#, EF Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"TenantSettings Repository"}),(0,i.jsx)(n.td,{children:"Gestiona configuraciones por tenant"}),(0,i.jsx)(n.td,{children:"C#, .NET 8, EF Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SecretsAndConfigs"}),(0,i.jsx)(n.td,{children:"Acceso centralizado a configuraciones y secretos"}),(0,i.jsx)(n.td,{children:"AWS Secrets Manager, AppConfig"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Observabilidad"}),(0,i.jsx)(n.td,{children:"Logging, m\xe9tricas, health checks"}),(0,i.jsx)(n.td,{children:"Serilog, Prometheus, HealthChecks"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"tracking-event-processor",children:"Tracking Event Processor"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Componentes Tracking Event Processor",src:d(67332).A+"",width:"5250",height:"2680"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Componente"}),(0,i.jsx)(n.th,{children:"Funci\xf3n"}),(0,i.jsx)(n.th,{children:"Tecnolog\xeda"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Consumer"}),(0,i.jsx)(n.td,{children:"Consume eventos desde la cola SQS"}),(0,i.jsx)(n.td,{children:"C#, AWS SDK (SQS)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Handler"}),(0,i.jsx)(n.td,{children:"Validaciones y reglas de negocio"}),(0,i.jsx)(n.td,{children:"C#"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Processing Service"}),(0,i.jsx)(n.td,{children:"L\xf3gica de negocio para enriquecimiento y correlaci\xf3n"}),(0,i.jsx)(n.td,{children:"C#"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Tracking Event Repository"}),(0,i.jsx)(n.td,{children:"Persiste eventos crudos y enriquecidos"}),(0,i.jsx)(n.td,{children:"C#, EF Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Downstream Event Publisher"}),(0,i.jsx)(n.td,{children:"Publica eventos procesados a sistemas downstream"}),(0,i.jsx)(n.td,{children:"C#, AWS SDK (SNS)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"TenantSettings Repository"}),(0,i.jsx)(n.td,{children:"Gestiona configuraciones por tenant"}),(0,i.jsx)(n.td,{children:"C#, .NET 8, EF Core"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SecretsAndConfigs"}),(0,i.jsx)(n.td,{children:"Acceso centralizado a configuraciones y secretos"}),(0,i.jsx)(n.td,{children:"AWS Secrets Manager, AppConfig"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Observabilidad"}),(0,i.jsx)(n.td,{children:"Logging, m\xe9tricas, health checks"}),(0,i.jsx)(n.td,{children:"Serilog, Prometheus, HealthChecks"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"53-esquemas-de-datos",children:"5.3 Esquemas de datos"}),"\n",(0,i.jsxs)(n.h3,{id:"tabla-tenant_tracking_settings",children:["Tabla: ",(0,i.jsx)(n.code,{children:"tenant_tracking_settings"})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"}),(0,i.jsx)(n.th,{children:"Restricciones"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"Identificador \xfanico"}),(0,i.jsx)(n.td,{children:"PRIMARY KEY"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tenant_id"}),(0,i.jsx)(n.td,{children:"VARCHAR(50)"}),(0,i.jsx)(n.td,{children:"Identificador del tenant"}),(0,i.jsx)(n.td,{children:"NOT NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"country_code"}),(0,i.jsx)(n.td,{children:"VARCHAR(5)"}),(0,i.jsx)(n.td,{children:"C\xf3digo de pa\xeds (PE, EC, CO, MX)"}),(0,i.jsx)(n.td,{children:"NOT NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"allowed_event_types"}),(0,i.jsx)(n.td,{children:"JSONB"}),(0,i.jsx)(n.td,{children:"Tipos de eventos permitidos (tracking, sita, etc.)"}),(0,i.jsx)(n.td,{children:"NOT NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"event_retention_days"}),(0,i.jsx)(n.td,{children:"INTEGER"}),(0,i.jsx)(n.td,{children:"D\xedas de retenci\xf3n de eventos"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"max_payload_size"}),(0,i.jsx)(n.td,{children:"INTEGER"}),(0,i.jsx)(n.td,{children:"Tama\xf1o m\xe1ximo permitido para eventos (bytes)"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"allowed_sources"}),(0,i.jsx)(n.td,{children:"JSONB"}),(0,i.jsx)(n.td,{children:"Sistemas/autores permitidos para registrar eventos"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"preferences"}),(0,i.jsx)(n.td,{children:"JSONB"}),(0,i.jsx)(n.td,{children:"Preferencias adicionales (idioma, formato, etc.)"}),(0,i.jsx)(n.td,{children:"NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"is_active"}),(0,i.jsx)(n.td,{children:"BOOLEAN"}),(0,i.jsx)(n.td,{children:"Configuraci\xf3n activa"}),(0,i.jsx)(n.td,{children:"DEFAULT true"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"created_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha de creaci\xf3n"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"updated_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha de actualizaci\xf3n"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ejemplo de datos:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"id"}),(0,i.jsx)(n.th,{children:"tenant_id"}),(0,i.jsx)(n.th,{children:"country_code"}),(0,i.jsx)(n.th,{children:"allowed_event_types"}),(0,i.jsx)(n.th,{children:"event_retention_days"}),(0,i.jsx)(n.th,{children:"max_payload_size"}),(0,i.jsx)(n.th,{children:"allowed_sources"}),(0,i.jsx)(n.th,{children:"preferences"}),(0,i.jsx)(n.th,{children:"is_active"}),(0,i.jsx)(n.th,{children:"created_at"}),(0,i.jsx)(n.th,{children:"updated_at"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"tenant-pe"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PE"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'["tracking","sita"]'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"365"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"1048576"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'["appPeru","sitaGW"]'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'{"idioma":"es"}'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"true"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"2025-08-13T07:00:00Z"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"2025-08-13T07:00:00Z"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"tenant-ec"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"EC"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'["tracking"]'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"180"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"524288"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'["appEcuador"]'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'{"idioma":"en"}'})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"true"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"2025-08-13T07:30:00Z"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"2025-08-13T07:30:00Z"})})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"tabla-event_store",children:"Tabla: event_store"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"}),(0,i.jsx)(n.th,{children:"Restricciones"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"Identificador \xfanico de evento"}),(0,i.jsx)(n.td,{children:"PRIMARY KEY"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tenant_id"}),(0,i.jsx)(n.td,{children:"VARCHAR(50)"}),(0,i.jsx)(n.td,{children:"Identificador del tenant"}),(0,i.jsx)(n.td,{children:"NOT NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"correlation_id"}),(0,i.jsx)(n.td,{children:"VARCHAR(100)"}),(0,i.jsx)(n.td,{children:"ID de correlaci\xf3n"}),(0,i.jsx)(n.td,{children:"NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"aggregate_id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"ID de la entidad agregada"}),(0,i.jsx)(n.td,{children:"NOT NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"event_type"}),(0,i.jsx)(n.td,{children:"VARCHAR(100)"}),(0,i.jsx)(n.td,{children:"Tipo de evento"}),(0,i.jsx)(n.td,{children:"NOT NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"payload"}),(0,i.jsx)(n.td,{children:"JSONB"}),(0,i.jsx)(n.td,{children:"Datos del evento"}),(0,i.jsx)(n.td,{children:"NOT NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timestamp"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha de ocurrencia"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"created_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha y hora de creaci\xf3n del registro"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"updated_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha y hora de \xfaltima actualizaci\xf3n"}),(0,i.jsx)(n.td,{children:"NULL"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"tabla-trace_views",children:"Tabla: trace_views"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"}),(0,i.jsx)(n.th,{children:"Restricciones"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"Identificador \xfanico"}),(0,i.jsx)(n.td,{children:"PRIMARY KEY"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tenant_id"}),(0,i.jsx)(n.td,{children:"VARCHAR(50)"}),(0,i.jsx)(n.td,{children:"Identificador del tenant"}),(0,i.jsx)(n.td,{children:"NOT NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"correlation_id"}),(0,i.jsx)(n.td,{children:"VARCHAR(100)"}),(0,i.jsx)(n.td,{children:"ID de correlaci\xf3n"}),(0,i.jsx)(n.td,{children:"NULL, INDEX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"view_type"}),(0,i.jsx)(n.td,{children:"VARCHAR(100)"}),(0,i.jsx)(n.td,{children:"Tipo de vista"}),(0,i.jsx)(n.td,{children:"NOT NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"data"}),(0,i.jsx)(n.td,{children:"JSONB"}),(0,i.jsx)(n.td,{children:"Datos optimizados para consulta"}),(0,i.jsx)(n.td,{children:"NOT NULL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"created_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"Fecha y hora de creaci\xf3n del registro"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"updated_at"}),(0,i.jsx)(n.td,{children:"TIMESTAMP"}),(0,i.jsx)(n.td,{children:"\xdaltima actualizaci\xf3n"}),(0,i.jsx)(n.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"ejemplo-de-contenido-y-actualizaci\xf3n-de-trace-view-para-trazabilidad",children:"Ejemplo de contenido y actualizaci\xf3n de trace view para trazabilidad"}),"\n",(0,i.jsxs)(n.p,{children:["El campo ",(0,i.jsx)(n.code,{children:"data"})," en la tabla ",(0,i.jsx)(n.code,{children:"trace_views"})," almacena la informaci\xf3n agregada y optimizada para cada correlaci\xf3n. Por ejemplo:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "correlation_id": "ABC123",\n  "status": "en_transito",\n  "events": [\n    { "event_type": "checked_in", "timestamp": "2025-09-11T08:00:00Z", "location": "LIM" },\n    { "event_type": "loaded", "timestamp": "2025-09-11T08:30:00Z", "location": "LIM" },\n    { "event_type": "arrived", "timestamp": "2025-09-11T09:15:00Z", "location": "JFK" }\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Cada vez que llega un nuevo evento para el ",(0,i.jsx)(n.code,{children:"correlation_id"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["El Event Processor procesa el evento y lo agrega al arreglo ",(0,i.jsx)(n.code,{children:"events"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["El campo ",(0,i.jsx)(n.code,{children:"status"})," se actualiza seg\xfan el \xfaltimo evento relevante."]}),"\n",(0,i.jsxs)(n.li,{children:["El registro en la tabla ",(0,i.jsx)(n.code,{children:"trace_views"})," se actualiza con el nuevo JSON."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ejemplo de actualizaci\xf3n:"})}),"\n",(0,i.jsx)(n.p,{children:"Si llega un evento:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ "event_type": "delivered", "timestamp": "2025-09-11T10:00:00Z", "location": "JFK" }\n'})}),"\n",(0,i.jsx)(n.p,{children:"El JSON actualizado ser\xeda:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "correlation_id": "ABC123",\n  "status": "delivered",\n  "events": [\n    { "event_type": "checked_in", "timestamp": "2025-09-11T08:00:00Z", "location": "LIM" },\n    { "event_type": "loaded", "timestamp": "2025-09-11T08:30:00Z", "location": "LIM" },\n    { "event_type": "arrived", "timestamp": "2025-09-11T09:15:00Z", "location": "JFK" },\n    { "event_type": "delivered", "timestamp": "2025-09-11T10:00:00Z", "location": "JFK" }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"54-endpoints-principales",children:"5.4 Endpoints principales"}),"\n",(0,i.jsx)(n.h3,{id:"endpoints-de-tracking-ingest-api",children:"Endpoints de Tracking Ingest API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/api/v1/events"}),": Ingesta de eventos operacionales (tracking, sita, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/events/health"}),": Estado de salud del API de ingesta"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/events/metrics"}),": M\xe9tricas de ingesta y procesamiento"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"endpoints-de-tracking-query-api",children:"Endpoints de Tracking Query API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/trace/{correlationId}"}),": Consulta de trazabilidad por correlaci\xf3n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/trace?aggregateId={aggregateId}"}),": Consulta de historial por entidad agregada"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/trace/health"}),": Estado de salud del API de consulta"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/api/v1/trace/metrics"}),": M\xe9tricas de consulta y uso"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"55-contratos-de-entrada-y-salida",children:"5.5 Contratos de entrada y salida"}),"\n",(0,i.jsx)(n.h3,{id:"contrato-de-entrada-eventrequest-tracking-ingest-api",children:"Contrato de entrada: EventRequest (Tracking Ingest API)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tenant_id"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Identificador del tenant"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"correlation_id"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"ID de correlaci\xf3n"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"aggregate_id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"ID de la entidad agregada"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"event_type"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Tipo de evento (tracking, sita, etc.)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"timestamp"}),(0,i.jsx)(n.td,{children:"string (ISO 8601)"}),(0,i.jsx)(n.td,{children:"Fecha de ocurrencia"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"payload"}),(0,i.jsx)(n.td,{children:"objeto"}),(0,i.jsx)(n.td,{children:"Datos del evento"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ejemplo:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "tenant_id": "talma-pe",\n    "correlation_id": "ABC123",\n    "aggregate_id": "BAG001",\n    "event_type": "tracking_arrived",\n    "timestamp": "2025-09-11T09:15:00Z",\n    "payload": {\n        "location": "JFK",\n        "operator": "Juan Perez"\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"contrato-de-salida-traceresponse-tracking-query-api",children:"Contrato de salida: TraceResponse (Tracking Query API)"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Campo"}),(0,i.jsx)(n.th,{children:"Tipo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"tenant_id"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Identificador del tenant"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"correlation_id"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"ID de correlaci\xf3n"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"aggregate_id"}),(0,i.jsx)(n.td,{children:"UUID"}),(0,i.jsx)(n.td,{children:"ID de la entidad agregada"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"status"}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Estado actual"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"events"}),(0,i.jsx)(n.td,{children:"array de objetos"}),(0,i.jsx)(n.td,{children:"Historial de eventos"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ejemplo:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "tenant_id": "talma-pe",\n    "correlation_id": "ABC123",\n    "aggregate_id": "BAG001",\n    "status": "arrived",\n    "events": [\n        { "event_type": "checked_in", "timestamp": "2025-09-11T08:00:00Z", "payload": { "location": "LIM" } },\n        { "event_type": "loaded", "timestamp": "2025-09-11T08:30:00Z", "payload": { "location": "LIM" } },\n        { "event_type": "arrived", "timestamp": "2025-09-11T09:15:00Z", "payload": { "location": "JFK" } }\n    ]\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},86058:(e,n,d)=>{d.d(n,{A:()=>s});const s=d.p+"assets/images/track_and_trace_system-43d88981ed6699c163bea36e401bc429.png"}}]);