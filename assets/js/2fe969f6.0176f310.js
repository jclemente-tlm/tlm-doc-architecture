"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[4222],{25726:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"servicios-corporativos/servicio-notificacion/decisiones-arquitectura","title":"9. Decisiones De Arquitectura","description":"9.1 Decisiones Principales","source":"@site/docs/servicios-corporativos/servicio-notificacion/09-decisiones-arquitectura.md","sourceDirName":"servicios-corporativos/servicio-notificacion","slug":"/servicios-corporativos/servicio-notificacion/decisiones-arquitectura","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/decisiones-arquitectura","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-notificacion/09-decisiones-arquitectura.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"8. Conceptos Transversales","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/conceptos-transversales"},"next":{"title":"10. Requisitos De Calidad","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/requisitos-calidad"}}');var r=n(74848),d=n(28453);const t={},a="9. Decisiones De Arquitectura",l={},c=[{value:"9.1 Decisiones Principales",id:"91-decisiones-principales",level:2},{value:"9.2 Alternativas Evaluadas",id:"92-alternativas-evaluadas",level:2},{value:"Resumen De Decisiones Arquitect\xf3nicas",id:"resumen-de-decisiones-arquitect\xf3nicas",level:2},{value:"ADR-001: Estrategia Multi-Proveedor",id:"adr-001-estrategia-multi-proveedor",level:2},{value:"ADR-002: Mensajer\xeda Basada En Base De Datos Y Redis",id:"adr-002-mensajer\xeda-basada-en-base-de-datos-y-redis",level:2},{value:"Ejemplo de definici\xf3n de colas",id:"ejemplo-de-definici\xf3n-de-colas",level:3},{value:"ADR-003: Motor De Plantillas Liquid Y RazorEngine",id:"adr-003-motor-de-plantillas-liquid-y-razorengine",level:2},{value:"Ejemplo de filtro personalizado",id:"ejemplo-de-filtro-personalizado",level:3},{value:"ADR-004: Arquitectura Dirigida Por Eventos",id:"adr-004-arquitectura-dirigida-por-eventos",level:2},{value:"Ejemplo de evento de dominio",id:"ejemplo-de-evento-de-dominio",level:3},{value:"ADR-005: Librer\xeda NuGet Multi-nube",id:"adr-005-librer\xeda-nuget-multi-nube",level:2}];function o(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"9-decisiones-de-arquitectura",children:"9. Decisiones De Arquitectura"})}),"\n",(0,r.jsx)(i.h2,{id:"91-decisiones-principales",children:"9.1 Decisiones Principales"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"ADR"}),(0,r.jsx)(i.th,{children:"Decisi\xf3n"}),(0,r.jsx)(i.th,{children:"Estado"}),(0,r.jsx)(i.th,{children:"Justificaci\xf3n"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-001"}),(0,r.jsx)(i.td,{children:"CQRS API + Processor"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Separaci\xf3n de responsabilidades"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-002"}),(0,r.jsx)(i.td,{children:"Redis como cola"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Rendimiento y simplicidad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-003"}),(0,r.jsx)(i.td,{children:"RazorEngine y Liquid plantillas"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Flexibilidad y seguridad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-004"}),(0,r.jsx)(i.td,{children:"Multi-canal handlers"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Extensibilidad y modularidad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-005"}),(0,r.jsx)(i.td,{children:"Mensajer\xeda basada en base de datos"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Portabilidad y cloud agnostic"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"92-alternativas-evaluadas",children:"9.2 Alternativas Evaluadas"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Componente"}),(0,r.jsx)(i.th,{children:"Alternativas"}),(0,r.jsx)(i.th,{children:"Selecci\xf3n"}),(0,r.jsx)(i.th,{children:"Raz\xf3n"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Cola"}),(0,r.jsx)(i.td,{children:"RabbitMQ, Redis, SQS"}),(0,r.jsx)(i.td,{children:"Redis"}),(0,r.jsx)(i.td,{children:"Simplicidad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Plantillas"}),(0,r.jsx)(i.td,{children:"Liquid, Handlebars, Razor"}),(0,r.jsx)(i.td,{children:"RazorEngine y Liquid"}),(0,r.jsx)(i.td,{children:".NET nativo y seguridad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Storage"}),(0,r.jsx)(i.td,{children:"S3, EFS, Database"}),(0,r.jsx)(i.td,{children:"EFS"}),(0,r.jsx)(i.td,{children:"Compartido"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"Canales"}),(0,r.jsx)(i.td,{children:"Monol\xedtico, Handlers"}),(0,r.jsx)(i.td,{children:"Handlers"}),(0,r.jsx)(i.td,{children:"Modularidad"})]})]})]}),"\n",(0,r.jsx)(i.p,{children:"Las decisiones arquitect\xf3nicas del sistema de notificaciones siguen los principios de:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Portabilidad entre nubes (cloud agnostic)"}),"\n",(0,r.jsx)(i.li,{children:"Contenedores primero"}),"\n",(0,r.jsx)(i.li,{children:"Mensajer\xeda centrada en base de datos y Redis"}),"\n",(0,r.jsx)(i.li,{children:"Multi-tenant nativo"}),"\n",(0,r.jsx)(i.li,{children:"Comunicaci\xf3n as\xedncrona basada en eventos de dominio"}),"\n",(0,r.jsx)(i.li,{children:"Abstracci\xf3n completa de proveedores"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"resumen-de-decisiones-arquitect\xf3nicas",children:"Resumen De Decisiones Arquitect\xf3nicas"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"#"}),(0,r.jsx)(i.th,{children:"Decisi\xf3n"}),(0,r.jsx)(i.th,{children:"Estado"}),(0,r.jsx)(i.th,{children:"Impacto"}),(0,r.jsx)(i.th,{children:"Fecha"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-001"}),(0,r.jsx)(i.td,{children:"Estrategia Multi-Proveedor"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Alto"}),(0,r.jsx)(i.td,{children:"2024-01-15"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-002"}),(0,r.jsx)(i.td,{children:"Mensajer\xeda Basada en Base de Datos"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Alto"}),(0,r.jsx)(i.td,{children:"2024-01-25"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-003"}),(0,r.jsx)(i.td,{children:"Motor de Plantillas Liquid y RazorEngine"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Medio"}),(0,r.jsx)(i.td,{children:"2024-02-05"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-004"}),(0,r.jsx)(i.td,{children:"Arquitectura Dirigida por Eventos"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Alto"}),(0,r.jsx)(i.td,{children:"2024-02-10"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:"ADR-005"}),(0,r.jsx)(i.td,{children:"Librer\xeda NuGet Multi-nube"}),(0,r.jsx)(i.td,{children:"Aprobado"}),(0,r.jsx)(i.td,{children:"Alto"}),(0,r.jsx)(i.td,{children:"2024-02-15"})]})]})]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.h2,{id:"adr-001-estrategia-multi-proveedor",children:"ADR-001: Estrategia Multi-Proveedor"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Alta disponibilidad y failover autom\xe1tico por canal (SendGrid, Twilio, FCM, WhatsApp Business API, SES, Mailgun, 360dialog)"}),"\n",(0,r.jsx)(i.li,{children:"Abstracci\xf3n de proveedores y selecci\xf3n din\xe1mica seg\xfan salud, costo y cobertura"}),"\n",(0,r.jsx)(i.li,{children:"Reducci\xf3n de SPOF y optimizaci\xf3n de costos"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"adr-002-mensajer\xeda-basada-en-base-de-datos-y-redis",children:"ADR-002: Mensajer\xeda Basada En Base De Datos Y Redis"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Uso de colas en ",(0,r.jsx)(i.code,{children:"PostgreSQL"})," y ",(0,r.jsx)(i.code,{children:"Redis"})," para mensajer\xeda y procesamiento as\xedncrono"]}),"\n",(0,r.jsx)(i.li,{children:"Portabilidad total entre nubes, sin vendor lock-in"}),"\n",(0,r.jsx)(i.li,{children:"ACID y durabilidad garantizada"}),"\n",(0,r.jsx)(i.li,{children:"Estrategia de migraci\xf3n futura a colas dedicadas si es necesario"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"ejemplo-de-definici\xf3n-de-colas",children:"Ejemplo de definici\xf3n de colas"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-yaml",children:"NotificationQueues:\n  email-notifications:\n    priority_levels: [1, 5, 10]\n    processing_timeout: 300s\n  sms-notifications:\n    priority_levels: [1, 5, 10]\n    processing_timeout: 120s\n  push-notifications:\n    priority_levels: [1, 5, 10]\n    processing_timeout: 60s\n  whatsapp-notifications:\n    priority_levels: [1, 5, 10]\n    processing_timeout: 180s\n"})}),"\n",(0,r.jsx)(i.h2,{id:"adr-003-motor-de-plantillas-liquid-y-razorengine",children:"ADR-003: Motor De Plantillas Liquid Y RazorEngine"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Plantillas seguras, internacionalizadas y editables por negocio"}),"\n",(0,r.jsx)(i.li,{children:"Ejecuci\xf3n en sandbox, filtros personalizados y soporte multi-idioma"}),"\n",(0,r.jsx)(i.li,{children:"Separaci\xf3n l\xf3gica/presentaci\xf3n y versionado de plantillas"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"ejemplo-de-filtro-personalizado",children:"Ejemplo de filtro personalizado"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:'public class CustomLiquidFilters\n{\n    public static string Translate(string key, object parameters = null)\n    {\n        var localizationService = ServiceLocator.GetService<ILocalizationService>();\n        return localizationService.GetLocalizedString(key, parameters);\n    }\n}\nTemplate.RegisterFilter("t", CustomLiquidFilters.Translate);\n'})}),"\n",(0,r.jsx)(i.h2,{id:"adr-004-arquitectura-dirigida-por-eventos",children:"ADR-004: Arquitectura Dirigida Por Eventos"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Eventos de dominio para comunicaci\xf3n as\xedncrona y desacoplada"}),"\n",(0,r.jsx)(i.li,{children:"Registro y auditor\xeda de eventos cr\xedticos (NotificationRequested, NotificationSent, NotificationDelivered, NotificationFailed)"}),"\n",(0,r.jsx)(i.li,{children:"Facilidad para agregar nuevos consumidores y handlers"}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"ejemplo-de-evento-de-dominio",children:"Ejemplo de evento de dominio"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-csharp",children:"public class NotificationRequested : NotificationDomainEvent\n{\n    public string NotificationId { get; set; }\n    public NotificationChannel Channel { get; set; }\n    public string TemplateId { get; set; }\n    public Dictionary<string, object> Variables { get; set; }\n    public List<string> Recipients { get; set; }\n    public Priority Priority { get; set; }\n    public DateTime? ScheduledAt { get; set; }\n}\n"})}),"\n",(0,r.jsx)(i.h2,{id:"adr-005-librer\xeda-nuget-multi-nube",children:"ADR-005: Librer\xeda NuGet Multi-nube"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"Abstracci\xf3n de servicios cloud para facilitar despliegue en AWS, Azure y GCP"}),"\n",(0,r.jsx)(i.li,{children:"Configuraci\xf3n centralizada y desacoplada"}),"\n",(0,r.jsx)(i.li,{children:"Soporte para almacenamiento, colas y notificaciones"}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsx)(i.p,{children:"Todas las decisiones, tecnolog\xedas y patrones aqu\xed documentados est\xe1n alineados con los DSL y ADRs oficiales del sistema. No se incluyen tecnolog\xedas no aprobadas ni patrones no implementados."})]})}function h(e={}){const{wrapper:i}={...(0,d.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>t,x:()=>a});var s=n(96540);const r={},d=s.createContext(r);function t(e){const i=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(d.Provider,{value:i},e.children)}}}]);