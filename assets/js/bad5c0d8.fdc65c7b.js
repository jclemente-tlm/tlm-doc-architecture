"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[7368],{28453:(e,i,s)=>{s.d(i,{R:()=>d,x:()=>a});var n=s(96540);const r={},c=n.createContext(r);function d(e){const i=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),n.createElement(c.Provider,{value:i},e.children)}},50766:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"servicios-corporativos/api-gateway/decisiones-arquitectura","title":"9. Decisiones de arquitectura","description":"9.1 Decisiones principales","source":"@site/docs/servicios-corporativos/api-gateway/09-decisiones-arquitectura.md","sourceDirName":"servicios-corporativos/api-gateway","slug":"/servicios-corporativos/api-gateway/decisiones-arquitectura","permalink":"/docs/servicios-corporativos/api-gateway/decisiones-arquitectura","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/api-gateway/09-decisiones-arquitectura.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"8. Conceptos transversales","permalink":"/docs/servicios-corporativos/api-gateway/conceptos-transversales"},"next":{"title":"10. Requisitos de calidad","permalink":"/docs/servicios-corporativos/api-gateway/requisitos-calidad"}}');var r=s(74848),c=s(28453);const d={},a="9. Decisiones de arquitectura",t={},l=[{value:"9.1 Decisiones principales",id:"91-decisiones-principales",level:2},{value:"9.2 Alternativas evaluadas",id:"92-alternativas-evaluadas",level:2},{value:"9.3 Decisiones clave (formato ADR)",id:"93-decisiones-clave-formato-adr",level:2},{value:"ADR-001: Proxy basado en YARP",id:"adr-001-proxy-basado-en-yarp",level:3},{value:"ADR-002: Rate limiting distribuido con Redis",id:"adr-002-rate-limiting-distribuido-con-redis",level:3},{value:"ADR-003: Circuit breaker adaptativo por servicio",id:"adr-003-circuit-breaker-adaptativo-por-servicio",level:3},{value:"ADR-004: Validaci\xf3n JWT local con cache y revocaci\xf3n diferida",id:"adr-004-validaci\xf3n-jwt-local-con-cache-y-revocaci\xf3n-diferida",level:3},{value:"ADR-005: Health checks multinivel y endpoints especializados",id:"adr-005-health-checks-multinivel-y-endpoints-especializados",level:3}];function o(e){const i={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"9-decisiones-de-arquitectura",children:"9. Decisiones de arquitectura"})}),"\n",(0,r.jsx)(i.h2,{id:"91-decisiones-principales",children:"9.1 Decisiones principales"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"ADR"}),(0,r.jsx)(i.th,{children:"Decisi\xf3n"}),(0,r.jsx)(i.th,{children:"Estado"}),(0,r.jsx)(i.th,{children:"Justificaci\xf3n"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ADR-001"})}),(0,r.jsxs)(i.td,{children:[(0,r.jsx)(i.code,{children:"YARP"})," como proxy"]}),(0,r.jsx)(i.td,{children:"Aceptado"}),(0,r.jsxs)(i.td,{children:["Integraci\xf3n ",(0,r.jsx)(i.code,{children:".NET"})," nativa"]})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ADR-002"})}),(0,r.jsxs)(i.td,{children:[(0,r.jsx)(i.code,{children:"Redis"})," rate limiting"]}),(0,r.jsx)(i.td,{children:"Aceptado"}),(0,r.jsx)(i.td,{children:"Escalabilidad y consistencia distribuida"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ADR-003"})}),(0,r.jsxs)(i.td,{children:[(0,r.jsx)(i.code,{children:"JWT"})," + ",(0,r.jsx)(i.code,{children:"OAuth2"})]}),(0,r.jsx)(i.td,{children:"Aceptado"}),(0,r.jsx)(i.td,{children:"Est\xe1ndar industria, interoperabilidad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ADR-004"})}),(0,r.jsx)(i.td,{children:"Multi-tenant realms"}),(0,r.jsx)(i.td,{children:"Aceptado"}),(0,r.jsx)(i.td,{children:"Aislamiento y flexibilidad"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"ADR-005"})}),(0,r.jsx)(i.td,{children:"Health checks multinivel"}),(0,r.jsx)(i.td,{children:"Aceptado"}),(0,r.jsx)(i.td,{children:"Observabilidad granular"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"92-alternativas-evaluadas",children:"9.2 Alternativas evaluadas"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Componente"}),(0,r.jsx)(i.th,{children:"Alternativas"}),(0,r.jsx)(i.th,{children:"Selecci\xf3n"}),(0,r.jsx)(i.th,{children:"Raz\xf3n"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Proxy"})}),(0,r.jsx)(i.td,{children:"NGINX, Envoy, YARP"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"YARP"})}),(0,r.jsxs)(i.td,{children:[(0,r.jsx)(i.code,{children:".NET"})," nativo, extensibilidad"]})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Rate Limiting"})}),(0,r.jsx)(i.td,{children:"In-memory, Redis, Database"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Redis"})}),(0,r.jsx)(i.td,{children:"Distribuido, baja latencia"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Auth"})}),(0,r.jsx)(i.td,{children:"Custom, Auth0, Keycloak"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Keycloak"})}),(0,r.jsx)(i.td,{children:"Control total, integraci\xf3n OIDC"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Observabilidad"})}),(0,r.jsx)(i.td,{children:"Custom, Datadog, Grafana"}),(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"Grafana Stack"})}),(0,r.jsx)(i.td,{children:"Agn\xf3stico, open source"})]})]})]}),"\n",(0,r.jsx)(i.h2,{id:"93-decisiones-clave-formato-adr",children:"9.3 Decisiones clave (formato ADR)"}),"\n",(0,r.jsx)(i.h3,{id:"adr-001-proxy-basado-en-yarp",children:"ADR-001: Proxy basado en YARP"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Estado"}),": Aceptado"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Fecha"}),": 2024-01-10"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisores"}),": Equipo de Arquitectura"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Contexto"}),": Se requiere un reverse proxy extensible, nativo en .NET, con soporte para middlewares y configuraci\xf3n din\xe1mica."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisi\xf3n"}),": Se selecciona ",(0,r.jsx)(i.code,{children:"YARP"})," por su integraci\xf3n nativa, soporte de middlewares y flexibilidad."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Consecuencias"}),": Integraci\xf3n r\xe1pida, reutilizaci\xf3n de stack, pero menor madurez frente a NGINX."]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"adr-002-rate-limiting-distribuido-con-redis",children:"ADR-002: Rate limiting distribuido con Redis"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Estado"}),": Aceptado"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Fecha"}),": 2024-01-20"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisores"}),": Equipo de Arquitectura"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Contexto"}),": Se requiere rate limiting consistente entre instancias, baja latencia y tolerancia a fallos."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisi\xf3n"}),": Se implementa rate limiting distribuido con ",(0,r.jsx)(i.code,{children:"Redis"})," (sliding window, fallback local)."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Consecuencias"}),": Consistencia, degradaci\xf3n graceful, pero complejidad operativa y dependencia externa."]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"adr-003-circuit-breaker-adaptativo-por-servicio",children:"ADR-003: Circuit breaker adaptativo por servicio"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Estado"}),": Aceptado"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Fecha"}),": 2024-01-25"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisores"}),": Arquitectura, SRE"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Contexto"}),": Prevenir fallos en cascada y sobrecarga de servicios backend."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisi\xf3n"}),": Circuit breakers independientes y adaptativos por servicio, con m\xe9tricas y backoff configurable."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Consecuencias"}),": Prevenci\xf3n efectiva, m\xe9tricas detalladas, pero tuning y debugging m\xe1s complejos."]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"adr-004-validaci\xf3n-jwt-local-con-cache-y-revocaci\xf3n-diferida",children:"ADR-004: Validaci\xf3n JWT local con cache y revocaci\xf3n diferida"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Estado"}),": Aceptado"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Fecha"}),": 2024-02-01"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisores"}),": Seguridad, Arquitectura"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Contexto"}),": Validar JWT tokens con baja latencia y resiliencia ante ca\xeddas del servicio de identidad."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisi\xf3n"}),": Validaci\xf3n local con cache y verificaci\xf3n peri\xf3dica con el servicio de identidad."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Consecuencias"}),": Latencia baja, resiliencia, pero posible ventana de inconsistencia."]}),"\n"]}),"\n",(0,r.jsx)(i.h3,{id:"adr-005-health-checks-multinivel-y-endpoints-especializados",children:"ADR-005: Health checks multinivel y endpoints especializados"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Estado"}),": Aceptado"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Fecha"}),": 2024-02-05"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisores"}),": SRE, DevOps"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Contexto"}),": Necesidad de monitoreo granular y decisiones de routing por estado real del sistema."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Decisi\xf3n"}),": Endpoints ",(0,r.jsx)(i.code,{children:"/health/live"}),", ",(0,r.jsx)(i.code,{children:"/health/ready"}),", ",(0,r.jsx)(i.code,{children:"/health/detailed"})," con chequeos por dependencia y recursos."]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.strong,{children:"Consecuencias"}),": Observabilidad granular, integraci\xf3n con Prometheus/Grafana, pero mayor complejidad de configuraci\xf3n."]}),"\n"]}),"\n",(0,r.jsx)(i.hr,{}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsx)(i.p,{children:"Todas las decisiones est\xe1n documentadas en formato ADR, alineadas a los modelos C4/Structurizr DSL y cumplen con los requisitos de seguridad, resiliencia, observabilidad y multi-tenancy definidos para el API Gateway."}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);