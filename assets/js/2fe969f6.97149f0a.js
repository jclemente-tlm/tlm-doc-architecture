"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[4222],{25726:(e,i,d)=>{d.r(i),d.d(i,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"servicios-corporativos/servicio-notificacion/decisiones-arquitectura","title":"9. Decisiones De Arquitectura","description":"9.1 Decisiones Principales","source":"@site/docs/servicios-corporativos/servicio-notificacion/09-decisiones-arquitectura.md","sourceDirName":"servicios-corporativos/servicio-notificacion","slug":"/servicios-corporativos/servicio-notificacion/decisiones-arquitectura","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/decisiones-arquitectura","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-notificacion/09-decisiones-arquitectura.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"8. Conceptos Transversales","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/conceptos-transversales"},"next":{"title":"10. Requisitos De Calidad","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/requisitos-calidad"}}');var s=d(74848),r=d(28453);const c={},l="9. Decisiones De Arquitectura",a={},o=[{value:"9.1 Decisiones Principales",id:"91-decisiones-principales",level:2},{value:"9.2 Alternativas Evaluadas",id:"92-alternativas-evaluadas",level:2},{value:"Resumen De Decisiones Arquitect\xf3nicas",id:"resumen-de-decisiones-arquitect\xf3nicas",level:2},{value:"<code>ADR-001</code>: Estrategia Multi-Proveedor",id:"adr-001-estrategia-multi-proveedor",level:2},{value:"<code>ADR-002</code>: Mensajer\xeda Basada En Base De Datos Y Redis",id:"adr-002-mensajer\xeda-basada-en-base-de-datos-y-redis",level:2},{value:"Ejemplo de definici\xf3n de colas",id:"ejemplo-de-definici\xf3n-de-colas",level:3},{value:"<code>ADR-003</code>: Motor De Plantillas Liquid Y RazorEngine",id:"adr-003-motor-de-plantillas-liquid-y-razorengine",level:2},{value:"Ejemplo de filtro personalizado",id:"ejemplo-de-filtro-personalizado",level:3},{value:"<code>ADR-004</code>: Arquitectura Dirigida Por Eventos",id:"adr-004-arquitectura-dirigida-por-eventos",level:2},{value:"Ejemplo de evento de dominio",id:"ejemplo-de-evento-de-dominio",level:3},{value:"<code>ADR-005</code>: Librer\xeda NuGet Multi-nube",id:"adr-005-librer\xeda-nuget-multi-nube",level:2}];function t(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"9-decisiones-de-arquitectura",children:"9. Decisiones De Arquitectura"})}),"\n",(0,s.jsx)(i.h2,{id:"91-decisiones-principales",children:"9.1 Decisiones Principales"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"ADR"}),(0,s.jsx)(i.th,{children:"Decisi\xf3n"}),(0,s.jsx)(i.th,{children:"Estado"}),(0,s.jsx)(i.th,{children:"Justificaci\xf3n"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-001"})}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"CQRS API"})}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Separaci\xf3n de responsabilidades"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-002"})}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"Redis"})," como cola"]}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Rendimiento y simplicidad"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-003"})}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"RazorEngine"})," y ",(0,s.jsx)(i.code,{children:"Liquid"})," plantillas"]}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Flexibilidad y seguridad"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-004"})}),(0,s.jsx)(i.td,{children:"Multi-canal handlers"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Extensibilidad y modularidad"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-005"})}),(0,s.jsx)(i.td,{children:"Mensajer\xeda basada en base de datos"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Portabilidad y cloud agnostic"})]})]})]}),"\n",(0,s.jsx)(i.h2,{id:"92-alternativas-evaluadas",children:"9.2 Alternativas Evaluadas"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Componente"}),(0,s.jsx)(i.th,{children:"Alternativas"}),(0,s.jsx)(i.th,{children:"Selecci\xf3n"}),(0,s.jsx)(i.th,{children:"Raz\xf3n"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Cola"}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"RabbitMQ"}),", ",(0,s.jsx)(i.code,{children:"Redis"}),", ",(0,s.jsx)(i.code,{children:"SQS"})]}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"Redis"})}),(0,s.jsx)(i.td,{children:"Simplicidad"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Plantillas"}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"Liquid"}),", ",(0,s.jsx)(i.code,{children:"Handlebars"}),", ",(0,s.jsx)(i.code,{children:"Razor"})]}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"RazorEngine"})," y ",(0,s.jsx)(i.code,{children:"Liquid"})]}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:".NET"})," nativo y seguridad"]})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Storage"}),(0,s.jsxs)(i.td,{children:[(0,s.jsx)(i.code,{children:"S3"}),", ",(0,s.jsx)(i.code,{children:"EFS"}),", ",(0,s.jsx)(i.code,{children:"Database"})]}),(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"EFS"})}),(0,s.jsx)(i.td,{children:"Compartido"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Canales"}),(0,s.jsx)(i.td,{children:"Monol\xedtico, Handlers"}),(0,s.jsx)(i.td,{children:"Handlers"}),(0,s.jsx)(i.td,{children:"Modularidad"})]})]})]}),"\n",(0,s.jsx)(i.p,{children:"Las decisiones arquitect\xf3nicas del sistema de notificaciones siguen los principios de:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Portabilidad entre nubes (",(0,s.jsx)(i.code,{children:"cloud agnostic"}),")"]}),"\n",(0,s.jsx)(i.li,{children:"Contenedores primero"}),"\n",(0,s.jsxs)(i.li,{children:["Mensajer\xeda centrada en base de datos y ",(0,s.jsx)(i.code,{children:"Redis"})]}),"\n",(0,s.jsx)(i.li,{children:"Multi-tenant nativo"}),"\n",(0,s.jsx)(i.li,{children:"Comunicaci\xf3n as\xedncrona basada en eventos de dominio"}),"\n",(0,s.jsx)(i.li,{children:"Abstracci\xf3n completa de proveedores"}),"\n",(0,s.jsx)(i.li,{children:"Desacoplamiento, resiliencia, deduplicaci\xf3n, idempotencia y observabilidad en todos los flujos cr\xedticos"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"resumen-de-decisiones-arquitect\xf3nicas",children:"Resumen De Decisiones Arquitect\xf3nicas"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"#"}),(0,s.jsx)(i.th,{children:"Decisi\xf3n"}),(0,s.jsx)(i.th,{children:"Estado"}),(0,s.jsx)(i.th,{children:"Impacto"}),(0,s.jsx)(i.th,{children:"Fecha"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-001"})}),(0,s.jsx)(i.td,{children:"Estrategia Multi-Proveedor"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Alto"}),(0,s.jsx)(i.td,{children:"2024-01-15"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-002"})}),(0,s.jsx)(i.td,{children:"Mensajer\xeda Basada en Base de Datos"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Alto"}),(0,s.jsx)(i.td,{children:"2024-01-25"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-003"})}),(0,s.jsxs)(i.td,{children:["Motor de Plantillas ",(0,s.jsx)(i.code,{children:"Liquid"})," y ",(0,s.jsx)(i.code,{children:"RazorEngine"})]}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Medio"}),(0,s.jsx)(i.td,{children:"2024-02-05"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-004"})}),(0,s.jsx)(i.td,{children:"Arquitectura Dirigida por Eventos"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Alto"}),(0,s.jsx)(i.td,{children:"2024-02-10"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.code,{children:"ADR-005"})}),(0,s.jsx)(i.td,{children:"Librer\xeda NuGet Multi-nube"}),(0,s.jsx)(i.td,{children:"Aprobado"}),(0,s.jsx)(i.td,{children:"Alto"}),(0,s.jsx)(i.td,{children:"2024-02-15"})]})]})]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsxs)(i.h2,{id:"adr-001-estrategia-multi-proveedor",children:[(0,s.jsx)(i.code,{children:"ADR-001"}),": Estrategia Multi-Proveedor"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Alta disponibilidad y failover autom\xe1tico por canal (",(0,s.jsx)(i.code,{children:"SendGrid"}),", ",(0,s.jsx)(i.code,{children:"Twilio"}),", ",(0,s.jsx)(i.code,{children:"FCM"}),", ",(0,s.jsx)(i.code,{children:"WhatsApp Business API"}),", ",(0,s.jsx)(i.code,{children:"SES"}),", ",(0,s.jsx)(i.code,{children:"Mailgun"}),", ",(0,s.jsx)(i.code,{children:"360dialog"}),")."]}),"\n",(0,s.jsx)(i.li,{children:"Abstracci\xf3n de proveedores y selecci\xf3n din\xe1mica seg\xfan salud, costo y cobertura."}),"\n",(0,s.jsxs)(i.li,{children:["Reducci\xf3n de ",(0,s.jsx)(i.code,{children:"SPOF"})," y optimizaci\xf3n de costos."]}),"\n"]}),"\n",(0,s.jsxs)(i.h2,{id:"adr-002-mensajer\xeda-basada-en-base-de-datos-y-redis",children:[(0,s.jsx)(i.code,{children:"ADR-002"}),": Mensajer\xeda Basada En Base De Datos Y Redis"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Uso de colas en ",(0,s.jsx)(i.code,{children:"PostgreSQL"})," y ",(0,s.jsx)(i.code,{children:"Redis"})," para mensajer\xeda y procesamiento as\xedncrono."]}),"\n",(0,s.jsx)(i.li,{children:"Portabilidad total entre nubes, sin vendor lock-in."}),"\n",(0,s.jsx)(i.li,{children:"ACID y durabilidad garantizada."}),"\n",(0,s.jsx)(i.li,{children:"Estrategia de migraci\xf3n futura a colas dedicadas si es necesario."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"ejemplo-de-definici\xf3n-de-colas",children:"Ejemplo de definici\xf3n de colas"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-yaml",children:"NotificationQueues:\n  email-notifications:\n    type: redis\n    retention: 7d\n  sms-notifications:\n    type: redis\n    retention: 7d\n  push-notifications:\n    type: redis\n    retention: 7d\n"})}),"\n",(0,s.jsxs)(i.h2,{id:"adr-003-motor-de-plantillas-liquid-y-razorengine",children:[(0,s.jsx)(i.code,{children:"ADR-003"}),": Motor De Plantillas Liquid Y RazorEngine"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Plantillas seguras, internacionalizadas y editables por negocio."}),"\n",(0,s.jsx)(i.li,{children:"Ejecuci\xf3n en sandbox, filtros personalizados y soporte multi-idioma."}),"\n",(0,s.jsx)(i.li,{children:"Separaci\xf3n l\xf3gica/presentaci\xf3n y versionado de plantillas."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"ejemplo-de-filtro-personalizado",children:"Ejemplo de filtro personalizado"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-csharp",children:'public class CustomLiquidFilters\n{\n    public static string Translate(string key, object parameters = null)\n    {\n        // ...l\xf3gica de traducci\xf3n...\n    }\n}\nTemplate.RegisterFilter("t", CustomLiquidFilters.Translate);\n'})}),"\n",(0,s.jsxs)(i.h2,{id:"adr-004-arquitectura-dirigida-por-eventos",children:[(0,s.jsx)(i.code,{children:"ADR-004"}),": Arquitectura Dirigida Por Eventos"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Eventos de dominio para comunicaci\xf3n as\xedncrona y desacoplada."}),"\n",(0,s.jsxs)(i.li,{children:["Registro y auditor\xeda de eventos cr\xedticos (",(0,s.jsx)(i.code,{children:"NotificationRequested"}),", ",(0,s.jsx)(i.code,{children:"NotificationSent"}),", ",(0,s.jsx)(i.code,{children:"NotificationDelivered"}),", ",(0,s.jsx)(i.code,{children:"NotificationFailed"}),")."]}),"\n",(0,s.jsx)(i.li,{children:"Facilidad para agregar nuevos consumidores y handlers."}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"ejemplo-de-evento-de-dominio",children:"Ejemplo de evento de dominio"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-csharp",children:"public class NotificationRequested : NotificationDomainEvent\n{\n    public string NotificationId { get; set; }\n    public DateTime? ScheduledAt { get; set; }\n}\n"})}),"\n",(0,s.jsxs)(i.h2,{id:"adr-005-librer\xeda-nuget-multi-nube",children:[(0,s.jsx)(i.code,{children:"ADR-005"}),": Librer\xeda NuGet Multi-nube"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:["Abstracci\xf3n de servicios cloud para facilitar despliegue en ",(0,s.jsx)(i.code,{children:"AWS"}),", ",(0,s.jsx)(i.code,{children:"Azure"})," y ",(0,s.jsx)(i.code,{children:"GCP"}),"."]}),"\n",(0,s.jsx)(i.li,{children:"Configuraci\xf3n centralizada y desacoplada."}),"\n"]}),"\n",(0,s.jsx)(i.hr,{}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Notas:"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Se priorizan la resiliencia, el desacoplamiento, la deduplicaci\xf3n, la idempotencia y la observabilidad en todos los flujos cr\xedticos."}),"\n",(0,s.jsx)(i.li,{children:"La documentaci\xf3n de ADRs se mantiene actualizada y enlazada a los diagramas y bloques principales."}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},28453:(e,i,d)=>{d.d(i,{R:()=>c,x:()=>l});var n=d(96540);const s={},r=n.createContext(s);function c(e){const i=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),n.createElement(r.Provider,{value:i},e.children)}}}]);