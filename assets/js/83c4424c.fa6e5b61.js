"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[7288],{28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var r=i(96540);const s={},a=r.createContext(s);function c(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(a.Provider,{value:n},e.children)}},45135:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"servicios-corporativos/servicio-notificacion/vista-tiempo-ejecucion","title":"6. Vista de tiempo de ejecuci\xf3n","description":"6.1 Escenarios principales","source":"@site/docs/servicios-corporativos/servicio-notificacion/06-vista-tiempo-ejecucion.md","sourceDirName":"servicios-corporativos/servicio-notificacion","slug":"/servicios-corporativos/servicio-notificacion/vista-tiempo-ejecucion","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/vista-tiempo-ejecucion","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-notificacion/06-vista-tiempo-ejecucion.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"5. Vista de Bloques de Construcci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/vista-bloques-construccion"},"next":{"title":"7. Vista de implementaci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/vista-implementacion"}}');var s=i(74848),a=i(28453);const c={},o="6. Vista de tiempo de ejecuci\xf3n",t={},l=[{value:"6.1 Escenarios principales",id:"61-escenarios-principales",level:2},{value:"6.2 Patrones de interacci\xf3n",id:"62-patrones-de-interacci\xf3n",level:2},{value:"6.3 Escenario: Env\xedo Transaccional Individual",id:"63-escenario-env\xedo-transaccional-individual",level:2},{value:"Descripci\xf3n del Env\xedo Transaccional",id:"descripci\xf3n-del-env\xedo-transaccional",level:3},{value:"Actores",id:"actores",level:3},{value:"Flujo Principal",id:"flujo-principal",level:3},{value:"Aspectos Notables",id:"aspectos-notables",level:3},{value:"M\xe9tricas de Rendimiento",id:"m\xe9tricas-de-rendimiento",level:3},{value:"6.4 Escenario: Procesamiento de Eventos Track &amp; Trace",id:"64-escenario-procesamiento-de-eventos-track--trace",level:2},{value:"Descripci\xf3n del Procesamiento de Eventos",id:"descripci\xf3n-del-procesamiento-de-eventos",level:3},{value:"Flujo de Eventos",id:"flujo-de-eventos",level:3},{value:"Caracter\xedsticas Especiales",id:"caracter\xedsticas-especiales",level:3},{value:"6.5 Escenario: Bulk Processing para Campa\xf1as",id:"65-escenario-bulk-processing-para-campa\xf1as",level:2},{value:"Descripci\xf3n del Bulk Processing",id:"descripci\xf3n-del-bulk-processing",level:3},{value:"Flujo de Batch Processing",id:"flujo-de-batch-processing",level:3},{value:"Optimizaciones Aplicadas",id:"optimizaciones-aplicadas",level:3},{value:"6.6 Escenario: Manejo de Errores y Retry",id:"66-escenario-manejo-de-errores-y-retry",level:2},{value:"Descripci\xf3n del Manejo de Errores",id:"descripci\xf3n-del-manejo-de-errores",level:3},{value:"Flujo de Resilience",id:"flujo-de-resilience",level:3},{value:"Pol\xedticas de Retry",id:"pol\xedticas-de-retry",level:3},{value:"6.7 Escenario: Monitoring y Observabilidad",id:"67-escenario-monitoring-y-observabilidad",level:2},{value:"Descripci\xf3n de Observabilidad",id:"descripci\xf3n-de-observabilidad",level:3},{value:"Pipeline de Observabilidad",id:"pipeline-de-observabilidad",level:3},{value:"M\xe9tricas Clave Capturadas",id:"m\xe9tricas-clave-capturadas",level:3},{value:"6.8 Escenario: Bulk de Notificaciones",id:"68-escenario-bulk-de-notificaciones",level:2},{value:"Descripci\xf3n del Bulk de Notificaciones",id:"descripci\xf3n-del-bulk-de-notificaciones",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n",level:3},{value:"Optimizaciones",id:"optimizaciones",level:3},{value:"6.9 Escenario: Failover y Recovery",id:"69-escenario-failover-y-recovery",level:2},{value:"Descripci\xf3n de Failover y Recovery",id:"descripci\xf3n-de-failover-y-recovery",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n-1",level:3},{value:"Recovery Policies",id:"recovery-policies",level:3},{value:"6.10 Escenario: Multi-canal con Fallback",id:"610-escenario-multi-canal-con-fallback",level:2},{value:"Descripci\xf3n Multi-canal con Fallback",id:"descripci\xf3n-multi-canal-con-fallback",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n-2",level:3},{value:"Fallback Chain",id:"fallback-chain",level:3},{value:"6.11 Escenario: Template Personalization",id:"611-escenario-template-personalization",level:2},{value:"Descripci\xf3n de Personalizaci\xf3n de Templates",id:"descripci\xf3n-de-personalizaci\xf3n-de-templates",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n-3",level:3},{value:"Personalization Features",id:"personalization-features",level:3},{value:"6.12 Escenario: Compliance y Opt-out",id:"612-escenario-compliance-y-opt-out",level:2},{value:"Descripci\xf3n de Compliance y Opt-out",id:"descripci\xf3n-de-compliance-y-opt-out",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n-4",level:3},{value:"Compliance Rules",id:"compliance-rules",level:3},{value:"6.13 Escenario: Analytics y Tracking",id:"613-escenario-analytics-y-tracking",level:2},{value:"Descripci\xf3n de Analytics y Tracking",id:"descripci\xf3n-de-analytics-y-tracking",level:3},{value:"Flujo de Ejecuci\xf3n",id:"flujo-de-ejecuci\xf3n-5",level:3},{value:"Tracked Metrics",id:"tracked-metrics",level:3},{value:"6.14 Consideraciones Generales",id:"614-consideraciones-generales",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"6-vista-de-tiempo-de-ejecuci\xf3n",children:"6. Vista de tiempo de ejecuci\xf3n"})}),"\n",(0,s.jsx)(n.h2,{id:"61-escenarios-principales",children:"6.1 Escenarios principales"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Escenario"}),(0,s.jsx)(n.th,{children:"Flujo"}),(0,s.jsx)(n.th,{children:"Componentes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Env\xedo inmediato"})}),(0,s.jsx)(n.td,{children:"API \u2192 Orchestrator \u2192 Handler"}),(0,s.jsx)(n.td,{children:"API, Processor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Env\xedo programado"})}),(0,s.jsx)(n.td,{children:"API \u2192 Repository \u2192 Scheduler"}),(0,s.jsx)(n.td,{children:"API, Processor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Procesamiento plantilla"})}),(0,s.jsx)(n.td,{children:"Template Engine \u2192 Handler"}),(0,s.jsx)(n.td,{children:"Processor"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"62-patrones-de-interacci\xf3n",children:"6.2 Patrones de interacci\xf3n"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Patr\xf3n"}),(0,s.jsx)(n.th,{children:"Descripci\xf3n"}),(0,s.jsx)(n.th,{children:"Tecnolog\xeda"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CQRS"})}),(0,s.jsx)(n.td,{children:"Separaci\xf3n comando/consulta"}),(0,s.jsx)(n.td,{children:"API/Processor"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Queue"})}),(0,s.jsx)(n.td,{children:"Cola de mensajes"}),(0,s.jsx)(n.td,{children:"Redis"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Template"})}),(0,s.jsx)(n.td,{children:"Procesamiento plantillas"}),(0,s.jsx)(n.td,{children:"RazorEngine"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Esta secci\xf3n describe los principales escenarios de ejecuci\xf3n del sistema, mostrando c\xf3mo los componentes interact\xfaan durante el tiempo de ejecuci\xf3n para cumplir con los casos de uso m\xe1s relevantes arquitect\xf3nicamente."}),"\n",(0,s.jsx)(n.h2,{id:"63-escenario-env\xedo-transaccional-individual",children:"6.3 Escenario: Env\xedo Transaccional Individual"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-del-env\xedo-transaccional",children:"Descripci\xf3n del Env\xedo Transaccional"}),"\n",(0,s.jsx)(n.p,{children:"Flujo cr\xedtico para notificaciones transaccionales de alta prioridad (confirmaciones, alertas cr\xedticas) que requieren entrega garantizada y baja latencia."}),"\n",(0,s.jsx)(n.h3,{id:"actores",children:"Actores"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Aplicaci\xf3n Cliente:"})," Sistema que origina la notificaci\xf3n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API Gateway:"})," Punto de entrada con autenticaci\xf3n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"API de Notificaci\xf3n:"})," Servicio de ingesta y validaci\xf3n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bus de Eventos:"})," Intermediario de mensajes para desacoplamiento"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Procesadores de Canal:"})," Procesadores especializados por canal"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Proveedores Externos:"})," Servicios de entrega (SendGrid, Twilio, etc.)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"flujo-principal",children:"Flujo Principal"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant App as Aplicaci\xf3n Cliente\n    participant Gateway as API Gateway\n    participant API as API de Notificaci\xf3n\n    participant EventBus as Bus de Eventos\n    participant Processor as Procesador de Canal\n    participant Provider as Proveedor Externo\n    participant DB as Base de Datos\n\n    App->>Gateway: 1. POST /notifications/send\n    Gateway->>Gateway: 2. Validar token JWT\n    Gateway->>API: 3. Reenviar solicitud\n\n    API->>API: 4. Validar payload y plantilla\n    API->>DB: 5. Almacenar registro de notificaci\xf3n\n    API->>Kafka: 6. Publicar evento de notificaci\xf3n\n    API->>App: 7. HTTP 202 Accepted {messageId}\n\n    Note over Kafka,Processor: Procesamiento As\xedncrono\n    Kafka->>Processor: 8. Consumir evento de notificaci\xf3n\n    Processor->>Processor: 9. Renderizar plantilla con datos\n    Processor->>Provider: 10. Send via provider API\n    Provider->>Processor: 11. Recibo de entrega\n    Processor->>DB: 12. Actualizar estado de entrega\n    Processor->>Kafka: 13. Publicar evento de estado\n\n    Note over Processor,App: Webhook Opcional\n    Processor->>App: 14. Webhook callback (if configured)"}),"\n",(0,s.jsx)(n.h3,{id:"aspectos-notables",children:"Aspectos Notables"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Respuesta inmediata:"})," API responde en ",(0,s.jsx)(n.code,{children:"< 100ms"})," con acknowledgment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Procesamiento as\xedncrono:"})," Desacopla ingesta de entrega"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Idempotencia:"})," Cada request incluye messageId para deduplicaci\xf3n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Observabilidad:"})," Cada paso genera telemetr\xeda para tracking"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"m\xe9tricas-de-rendimiento",children:"M\xe9tricas de Rendimiento"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"M\xe9trica"}),(0,s.jsx)(n.th,{children:"Target"}),(0,s.jsx)(n.th,{children:"Medici\xf3n"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"API Response Time"})}),(0,s.jsx)(n.td,{children:"p95 < 100ms"}),(0,s.jsx)(n.td,{children:"APM monitoring"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Event Processing"})}),(0,s.jsx)(n.td,{children:"< 500ms"}),(0,s.jsx)(n.td,{children:"Custom metrics"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"End-to-End Delivery"})}),(0,s.jsx)(n.td,{children:"< 30s (transactional)"}),(0,s.jsx)(n.td,{children:"Business metrics"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Capacidad de procesamiento"})}),(0,s.jsx)(n.td,{children:"10K req/min per instance"}),(0,s.jsx)(n.td,{children:"Load testing"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"64-escenario-procesamiento-de-eventos-track--trace",children:"6.4 Escenario: Procesamiento de Eventos Track & Trace"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-del-procesamiento-de-eventos",children:"Descripci\xf3n del Procesamiento de Eventos"}),"\n",(0,s.jsx)(n.p,{children:"Flujo autom\xe1tico triggered por eventos del sistema Track & Trace para notificaciones operacionales como actualizaciones de vuelo, cambios de puerta, etc."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-eventos",children:"Flujo de Eventos"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant TrackTrace as Track & Trace\n    participant EventBus as Event Bus\n    participant EventConsumer as Event Consumer\n    participant TemplateEngine as Template Engine\n    participant ChannelRouter as Channel Router\n    participant Processors as Channel Processors\n\n    TrackTrace->>Kafka: 1. Publish flight event\n    EventConsumer->>Kafka: 2. Consume event\n    EventConsumer->>EventConsumer: 3. Transform to notification\n    EventConsumer->>TemplateEngine: 4. Get template by event type\n    TemplateEngine->>EventConsumer: 5. Return template definition\n    EventConsumer->>ChannelRouter: 6. Route to appropriate channels\n\n    par Email Channel\n        ChannelRouter->>Processors: 7a. Email notification\n    and SMS Channel\n        ChannelRouter->>Processors: 7b. SMS notification\n    and Push Channel\n        ChannelRouter->>Processors: 7c. Push notification\n    end\n\n    Processors->>Processors: 8. Process in parallel"}),"\n",(0,s.jsx)(n.h3,{id:"caracter\xedsticas-especiales",children:"Caracter\xedsticas Especiales"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Event-driven:"})," Triggered autom\xe1ticamente por eventos externos"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Transformaci\xf3n de datos:"})," Mapping de eventos a formato de notificaci\xf3n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multi-canal autom\xe1tico:"})," Routing inteligente seg\xfan preferencias"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Procesamiento paralelo:"})," Canales procesan simult\xe1neamente"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"65-escenario-bulk-processing-para-campa\xf1as",children:"6.5 Escenario: Bulk Processing para Campa\xf1as"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-del-bulk-processing",children:"Descripci\xf3n del Bulk Processing"}),"\n",(0,s.jsx)(n.p,{children:"Procesamiento optimizado para env\xedo masivo de notificaciones promocionales con limitaci\xf3n de velocidad y batch processing."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-batch-processing",children:"Flujo de Batch Processing"}),"\n",(0,s.jsx)(n.mermaid,{value:"flowchart TD\n    A[Bulk Request] --\x3e B[Validate Batch]\n    B --\x3e C[Split into Chunks]\n    C --\x3e D[Queue Chunks]\n\n    D --\x3e E[Batch Processor 1]\n    D --\x3e F[Batch Processor 2]\n    D --\x3e G[Batch Processor N]\n\n    E --\x3e H[Rate Limiter]\n    F --\x3e H\n    G --\x3e H\n\n    H --\x3e I[Provider APIs]\n    I --\x3e J[Delivery Tracking]\n    J --\x3e K[Aggregate Results]"}),"\n",(0,s.jsx)(n.h3,{id:"optimizaciones-aplicadas",children:"Optimizaciones Aplicadas"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Chunking:"})," Divisi\xf3n en lotes de 100-1000 recipients"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Limitaci\xf3n de Velocidad:"})," Respeto a l\xedmites de providers"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch APIs:"})," Uso de APIs batch cuando est\xe1n disponibles"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Circuit Breaker:"})," Protecci\xf3n contra failures de providers"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"66-escenario-manejo-de-errores-y-retry",children:"6.6 Escenario: Manejo de Errores y Retry"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-del-manejo-de-errores",children:"Descripci\xf3n del Manejo de Errores"}),"\n",(0,s.jsx)(n.p,{children:"Manejo de errores y sistema de reintentos con exponential backoff para garantizar entrega."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-resilience",children:"Flujo de Resilience"}),"\n",(0,s.jsx)(n.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e Pending\n    Pending --\x3e Processing: Dequeue\n    Processing --\x3e Sent: Success\n    Processing --\x3e Retry: Transient Error\n    Processing --\x3e Failed: Permanent Error\n\n    Retry --\x3e Processing: Backoff Delay\n    Retry --\x3e DLQ: Max Retries Exceeded\n\n    Sent --\x3e Delivered: Provider Confirmation\n    Sent --\x3e Bounced: Provider Error\n\n    Failed --\x3e [*]\n    Delivered --\x3e [*]\n    Bounced --\x3e [*]\n    DLQ --\x3e [*]"}),"\n",(0,s.jsx)(n.h3,{id:"pol\xedticas-de-retry",children:"Pol\xedticas de Retry"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Error Type"}),(0,s.jsx)(n.th,{children:"Retry Count"}),(0,s.jsx)(n.th,{children:"Backoff"}),(0,s.jsx)(n.th,{children:"Dead Letter"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Network Timeout"})}),(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"Exponential (2s, 4s, 8s)"}),(0,s.jsx)(n.td,{children:"After 3 failures"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Rate Limit"})}),(0,s.jsx)(n.td,{children:"5"}),(0,s.jsx)(n.td,{children:"Linear (60s intervals)"}),(0,s.jsx)(n.td,{children:"After 5 failures"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Provider Error 5xx"})}),(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"Exponential"}),(0,s.jsx)(n.td,{children:"After 3 failures"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Invalid Data"})}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"None"}),(0,s.jsx)(n.td,{children:"Immediate"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"67-escenario-monitoring-y-observabilidad",children:"6.7 Escenario: Monitoring y Observabilidad"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-de-observabilidad",children:"Descripci\xf3n de Observabilidad"}),"\n",(0,s.jsx)(n.p,{children:"Flujo de telemetr\xeda y m\xe9tricas para observabilidad del sistema en tiempo real."}),"\n",(0,s.jsx)(n.h3,{id:"pipeline-de-observabilidad",children:"Pipeline de Observabilidad"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[Application] --\x3e B[OpenTelemetry]\n    B --\x3e C[Jaeger Tracing]\n    B --\x3e D[Prometheus Metrics]\n    B --\x3e E[Structured Logs]\n\n    C --\x3e F[Trace Analysis]\n    D --\x3e G[Grafana Dashboards]\n    E --\x3e H[Log Aggregation]\n\n    F --\x3e I[Performance Insights]\n    G --\x3e J[Alertas]\n    H --\x3e K[Error Analysis]"}),"\n",(0,s.jsx)(n.h3,{id:"m\xe9tricas-clave-capturadas",children:"M\xe9tricas Clave Capturadas"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Request Rate:"})," Notifications per second by channel"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Rate:"})," Failed notifications percentage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Latency:"})," p50, p95, p99 processing times"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Provider Health:"})," External API disponibilidad"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Queue Depth:"})," Backlog size by priority"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Cada escenario incluye puntos de instrumentaci\xf3n espec\xedficos para resoluci\xf3n de problemas y optimizaci\xf3n continua."}),"\n",(0,s.jsx)(n.h2,{id:"68-escenario-bulk-de-notificaciones",children:"6.8 Escenario: Bulk de Notificaciones"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-del-bulk-de-notificaciones",children:"Descripci\xf3n del Bulk de Notificaciones"}),"\n",(0,s.jsx)(n.p,{children:"Env\xedo masivo de notificaciones con optimizaciones de batch processing."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client as Cliente\n    participant API as Notification API\n    participant Splitter as Batch Splitter\n    participant Queue as Message Queue\n    participant Workers as Parallel Workers\n    participant Providers as Multiple Providers\n\n    Client->>API: 1. POST /notifications/bulk (10K recipients)\n    API->>Splitter: 2. Split into batches (100 each)\n    Splitter->>Queue: 3. Enqueue 100 batches\n    API->>Client: 4. HTTP 202 Batch accepted\n\n    loop Parallel Processing\n        Queue->>Workers: 5. Dequeue batch\n        Workers->>Providers: 6. Send batch via different providers\n        Providers->>Workers: 7. Batch results\n        Workers->>Queue: 8. Update batch status\n    end"}),"\n",(0,s.jsx)(n.h3,{id:"optimizaciones",children:"Optimizaciones"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch size:"})," 100 recipients per batch"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parallel workers:"})," 10 concurrent processors"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Provider rotation:"})," Load balancing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Retry policy:"})," Exponential backoff"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"69-escenario-failover-y-recovery",children:"6.9 Escenario: Failover y Recovery"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-de-failover-y-recovery",children:"Descripci\xf3n de Failover y Recovery"}),"\n",(0,s.jsx)(n.p,{children:"Manejo de fallos de proveedor con failover autom\xe1tico."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n-1",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Processor as Email Processor\n    participant Primary as Primary Provider\n    participant Secondary as Secondary Provider\n    participant Circuit as Circuit Breaker\n    participant Monitor as Health Monitor\n\n    Processor->>Primary: 1. Send email\n    Primary--\x3e>Processor: 2. Timeout/Error\n    Processor->>Circuit: 3. Record failure\n    Circuit->>Circuit: 4. Trip circuit after 5 failures\n    Processor->>Secondary: 5. Failover to secondary\n    Secondary->>Processor: 6. Success response\n\n    Monitor->>Primary: 7. Health check\n    Primary->>Monitor: 8. Service restored\n    Monitor->>Circuit: 9. Reset circuit"}),"\n",(0,s.jsx)(n.h3,{id:"recovery-policies",children:"Recovery Policies"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Circuit breaker:"})," 5 fallos consecutivos"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Timeout:"})," 30 segundos por provider"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Health check:"})," Cada 60 segundos"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Auto-recovery:"})," Autom\xe1tico cuando provider responde"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"610-escenario-multi-canal-con-fallback",children:"6.10 Escenario: Multi-canal con Fallback"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-multi-canal-con-fallback",children:"Descripci\xf3n Multi-canal con Fallback"}),"\n",(0,s.jsx)(n.p,{children:"Env\xedo por canal preferido con fallback autom\xe1tico a canales alternativos."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n-2",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client as Cliente\n    participant API as Notification API\n    participant Router as Channel Router\n    participant WhatsApp as WhatsApp Processor\n    participant SMS as SMS Processor\n    participant Email as Email Processor\n\n    Client->>API: 1. Send notification (preference: WhatsApp)\n    API->>Router: 2. Route to preferred channel\n    Router->>WhatsApp: 3. Attempt WhatsApp delivery\n    WhatsApp--\x3e>Router: 4. User not registered\n    Router->>SMS: 5. Fallback to SMS\n    SMS->>Router: 6. SMS sent successfully\n    Router->>API: 7. Delivery confirmation\n    API->>Client: 8. Success response with actual channel"}),"\n",(0,s.jsx)(n.h3,{id:"fallback-chain",children:"Fallback Chain"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"Channel Priorities:\n  High Priority:\n    1. WhatsApp Business\n    2. SMS\n    3. Email\n    4. Push Notification\n\n  Standard Priority:\n    1. Email\n    2. SMS\n    3. Push Notification\n\n  Marketing:\n    1. Email\n    2. Push Notification\n"})}),"\n",(0,s.jsx)(n.h2,{id:"611-escenario-template-personalization",children:"6.11 Escenario: Template Personalization"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-de-personalizaci\xf3n-de-templates",children:"Descripci\xf3n de Personalizaci\xf3n de Templates"}),"\n",(0,s.jsx)(n.p,{children:"Procesamiento de templates con personalizaci\xf3n din\xe1mica y localizaci\xf3n."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n-3",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Processor as Notification Processor\n    participant TemplateEngine as Template Engine\n    participant UserService as User Service\n    participant LocalizationService as Localization Service\n    participant ContentDB as Content Database\n\n    Processor->>TemplateEngine: 1. Process template request\n    TemplateEngine->>UserService: 2. Get user profile\n    UserService->>TemplateEngine: 3. User data + preferences\n    TemplateEngine->>LocalizationService: 4. Get localized content\n    LocalizationService->>ContentDB: 5. Fetch templates by locale\n    ContentDB->>LocalizationService: 6. Localized templates\n    LocalizationService->>TemplateEngine: 7. Localized content\n    TemplateEngine->>Processor: 8. Rendered notification"}),"\n",(0,s.jsx)(n.h3,{id:"personalization-features",children:"Personalization Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dynamic Content:"})," Variables from user profile"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conditional Logic:"})," if/else based on user attributes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Localization:"})," Multiple languages and regions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"A/B Testing:"})," Template variant selection"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"612-escenario-compliance-y-opt-out",children:"6.12 Escenario: Compliance y Opt-out"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-de-compliance-y-opt-out",children:"Descripci\xf3n de Compliance y Opt-out"}),"\n",(0,s.jsx)(n.p,{children:"Manejo de preferencias de usuario y compliance con regulaciones."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n-4",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client as Cliente\n    participant API as Notification API\n    participant ComplianceService as Compliance Service\n    participant PreferenceDB as Preference Database\n    participant AuditService as Audit Service\n\n    Client->>API: 1. Send marketing notification\n    API->>ComplianceService: 2. Check user preferences\n    ComplianceService->>PreferenceDB: 3. Get opt-in status\n    PreferenceDB->>ComplianceService: 4. User opted out\n    ComplianceService->>AuditService: 5. Log blocked notification\n    ComplianceService->>API: 6. Notification blocked\n    API->>Client: 7. HTTP 403 User opted out"}),"\n",(0,s.jsx)(n.h3,{id:"compliance-rules",children:"Compliance Rules"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"GDPR:"})," Explicit consent required"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CAN-SPAM:"})," Easy unsubscribe mechanism"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TCPA:"})," SMS consent verification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regional Laws:"})," Country-specific regulations"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"613-escenario-analytics-y-tracking",children:"6.13 Escenario: Analytics y Tracking"}),"\n",(0,s.jsx)(n.h3,{id:"descripci\xf3n-de-analytics-y-tracking",children:"Descripci\xf3n de Analytics y Tracking"}),"\n",(0,s.jsx)(n.p,{children:"Captura de m\xe9tricas de entrega y engagement para analytics."}),"\n",(0,s.jsx)(n.h3,{id:"flujo-de-ejecuci\xf3n-5",children:"Flujo de Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Provider as Email Provider\n    participant Webhook as Webhook Handler\n    participant EventProcessor as Event Processor\n    participant AnalyticsDB as Analytics Database\n    participant Dashboard as Analytics Dashboard\n\n    Provider->>Webhook: 1. Delivery webhook\n    Webhook->>EventProcessor: 2. Process delivery event\n    EventProcessor->>AnalyticsDB: 3. Store metrics\n\n    Note over Provider: User opens email\n    Provider->>Webhook: 4. Open tracking webhook\n    Webhook->>EventProcessor: 5. Process open event\n    EventProcessor->>AnalyticsDB: 6. Update engagement metrics\n\n    Dashboard->>AnalyticsDB: 7. Query real-time metrics\n    AnalyticsDB->>Dashboard: 8. Return aggregated data"}),"\n",(0,s.jsx)(n.h3,{id:"tracked-metrics",children:"Tracked Metrics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Delivery Rates:"})," Successful deliveries per channel"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Open Rates:"})," Email opens, SMS reads"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Click Rates:"})," Link clicks, call-to-action engagement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conversion Rates:"})," Business goal completions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bounce Rates:"})," Failed deliveries by reason"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"614-consideraciones-generales",children:"6.14 Consideraciones Generales"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reintentos autom\xe1ticos"})," ante fallos de canal"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Trazabilidad"})," de cada mensaje"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Aislamiento multi-tenant"})," en cada paso"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Logs estructurados"})," para auditor\xeda"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);