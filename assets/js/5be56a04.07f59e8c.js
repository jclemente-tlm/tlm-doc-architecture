"use strict";(self.webpackChunktlm_doc_architecture=self.webpackChunktlm_doc_architecture||[]).push([[3907],{28453:(e,d,i)=>{i.d(d,{R:()=>r,x:()=>t});var s=i(96540);const n={},c=s.createContext(n);function r(e){const d=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(d):{...d,...e}},[d,e])}function t(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(c.Provider,{value:d},e.children)}},29260:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_scheduler-c2166af22a6ea2fd10eb39e81abbd7a5.png"},42334:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_email_processor-3f1d078f44e8fb0c7ad5006ebc16a805.png"},49125:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_sms_processor-e33e80defcd3fa2bab0b1a598fc5982f.png"},49628:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_whatsapp_processor-295587224bbd29b346e9b73596e81ee9.png"},52774:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system-947d6665b1cfc4e00e5cf1bf38915f78.png"},61019:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_api-96dc91d8c802a45baf4fcf082a489d42.png"},70181:(e,d,i)=>{i.r(d),i.d(d,{assets:()=>l,contentTitle:()=>t,default:()=>a,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"servicios-corporativos/servicio-notificacion/vista-bloques-construccion","title":"5. Vista De Bloques De Construcci\xf3n","description":"Esta secci\xf3n describe la estructura modular y desacoplada del Sistema de Notificaci\xf3n, detallando contenedores, componentes, esquemas de datos, APIs y ejemplos de implementaci\xf3n. Se incluyen diagramas C4 para ilustrar la arquitectura y la interacci\xf3n entre los bloques principales, priorizando la escalabilidad, resiliencia y observabilidad.","source":"@site/docs/servicios-corporativos/servicio-notificacion/05-vista-bloques-construccion.md","sourceDirName":"servicios-corporativos/servicio-notificacion","slug":"/servicios-corporativos/servicio-notificacion/vista-bloques-construccion","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/vista-bloques-construccion","draft":false,"unlisted":false,"editUrl":"https://github.com/jclemente-tlm/tlm-doc-architecture/edit/main/docs/servicios-corporativos/servicio-notificacion/05-vista-bloques-construccion.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"4. Estrategia De Soluci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/estrategia-solucion"},"next":{"title":"6. Vista De Tiempo De Ejecuci\xf3n","permalink":"/tlm-doc-architecture/docs/servicios-corporativos/servicio-notificacion/vista-tiempo-ejecucion"}}');var n=i(74848),c=i(28453);const r={},t="5. Vista De Bloques De Construcci\xf3n",l={},h=[{value:"5.1 Contenedores Principales",id:"51-contenedores-principales",level:2},{value:"5.2 Vista de Componentes y Detalles",id:"52-vista-de-componentes-y-detalles",level:2},{value:"Email Processor",id:"email-processor",level:3},{value:"SMS Processor",id:"sms-processor",level:3},{value:"WhatsApp Processor",id:"whatsapp-processor",level:3},{value:"Push Processor",id:"push-processor",level:3},{value:"Scheduler",id:"scheduler",level:3},{value:"5.4 Esquemas De Base De Datos",id:"54-esquemas-de-base-de-datos",level:2},{value:"5.4.1 Modelo de Datos (ER)",id:"541-modelo-de-datos-er",level:2},{value:"5.4.2 Tabla: <code>notifications</code>",id:"542-tabla-notifications",level:3},{value:"5.4.3 Tabla: <code>notification_logs</code>",id:"543-tabla-notification_logs",level:3},{value:"5.4.4 Tabla: <code>notification_templates</code>",id:"544-tabla-notification_templates",level:3},{value:"5.4.5 Tabla: <code>scheduled_notifications</code>",id:"545-tabla-scheduled_notifications",level:3},{value:"5.4.6 Tabla: <code>tenant_notification_settings</code>",id:"546-tabla-tenant_notification_settings",level:3},{value:"5.5 Endpoints De API",id:"55-endpoints-de-api",level:2},{value:"5.5.1 Notification API",id:"551-notification-api",level:3},{value:"5.5.2 Attachment API",id:"552-attachment-api",level:3},{value:"5.6 Contratos De Datos (DTOs)",id:"56-contratos-de-datos-dtos",level:2},{value:"5.6.1 NotificationRequest (Contrato)",id:"561-notificationrequest-contrato",level:3},{value:"Ejemplo de contrato NotificationRequest",id:"ejemplo-de-contrato-notificationrequest",level:4}];function o(e){const d={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",img:"img",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.header,{children:(0,n.jsx)(d.h1,{id:"5-vista-de-bloques-de-construcci\xf3n",children:"5. Vista De Bloques De Construcci\xf3n"})}),"\n",(0,n.jsx)(d.p,{children:"Esta secci\xf3n describe la estructura modular y desacoplada del Sistema de Notificaci\xf3n, detallando contenedores, componentes, esquemas de datos, APIs y ejemplos de implementaci\xf3n. Se incluyen diagramas C4 para ilustrar la arquitectura y la interacci\xf3n entre los bloques principales, priorizando la escalabilidad, resiliencia y observabilidad."}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Vista General del Sistema de Notificaci\xf3n",src:i(52774).A+"",width:"7297",height:"3645"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.1: Contenedores principales del sistema"})]}),"\n",(0,n.jsx)(d.h2,{id:"51-contenedores-principales",children:"5.1 Contenedores Principales"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Contenedor"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Notification API"})}),(0,n.jsx)(d.td,{children:"Recepci\xf3n, validaci\xf3n, orquestaci\xf3n, deduplicaci\xf3n e idempotencia de solicitudes, gesti\xf3n de plantillas"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:".NET 8 Web API"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Notification Database"})}),(0,n.jsx)(d.td,{children:"Persistencia, auditor\xeda, versionado de datos y plantillas"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PostgreSQL 15+"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"emailQueue"})}),(0,n.jsxs)(d.td,{children:["Desacoplamiento y buffering de mensajes ",(0,n.jsx)(d.code,{children:"email"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS SQS"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"smsQueue"})}),(0,n.jsxs)(d.td,{children:["Desacoplamiento y buffering de mensajes ",(0,n.jsx)(d.code,{children:"SMS"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS SQS"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"whatsappQueue"})}),(0,n.jsxs)(d.td,{children:["Desacoplamiento y buffering de mensajes ",(0,n.jsx)(d.code,{children:"WhatsApp"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS SQS"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"pushQueue"})}),(0,n.jsxs)(d.td,{children:["Desacoplamiento y buffering de mensajes ",(0,n.jsx)(d.code,{children:"push"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS SQS"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"SNS"})," (opcional)"]}),(0,n.jsx)(d.td,{children:"Fan-out y routing avanzado a colas SQS"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS SNS"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Email Processor"})}),(0,n.jsxs)(d.td,{children:["Procesamiento y entrega de ",(0,n.jsx)(d.code,{children:"email"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:".NET 8 Worker Service"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"SMS Processor"})}),(0,n.jsxs)(d.td,{children:["Procesamiento y entrega de ",(0,n.jsx)(d.code,{children:"SMS"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:".NET 8 Worker Service"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WhatsApp Processor"})}),(0,n.jsxs)(d.td,{children:["Procesamiento y entrega de ",(0,n.jsx)(d.code,{children:"WhatsApp"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:".NET 8 Worker Service"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Push Processor"})}),(0,n.jsxs)(d.td,{children:["Procesamiento y entrega de notificaciones ",(0,n.jsx)(d.code,{children:"push"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:".NET 8 Worker Service"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Attachment Storage"})}),(0,n.jsx)(d.td,{children:"Almacenamiento seguro y escalable de adjuntos"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"AWS S3"})})]})]})]}),"\n",(0,n.jsxs)(d.blockquote,{children:["\n",(0,n.jsxs)(d.p,{children:["La deduplicaci\xf3n, idempotencia y versionado de plantillas son responsabilidades internas de los componentes principales (",(0,n.jsx)(d.code,{children:"Notification API"}),", ",(0,n.jsx)(d.code,{children:"Template Controller"}),", ",(0,n.jsx)(d.code,{children:"Notification Database"}),") y se implementan mediante l\xf3gica de aplicaci\xf3n, claves de idempotencia y versionado en base de datos, no como contenedores independientes."]}),"\n"]}),"\n",(0,n.jsx)(d.h2,{id:"52-vista-de-componentes-y-detalles",children:"5.2 Vista de Componentes y Detalles"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes Notification API",src:i(61019).A+"",width:"6270",height:"4450"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.2: Componentes internos de Notification API"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Notification Controller"})}),(0,n.jsxs)(d.td,{children:["Exposici\xf3n de endpoints ",(0,n.jsx)(d.code,{children:"REST"}),", control de acceso, deduplicaci\xf3n e idempotencia"]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ASP.NET Core"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Template Controller"})}),(0,n.jsxs)(d.td,{children:["Gesti\xf3n de plantillas con versionado e ",(0,n.jsx)(d.code,{children:"i18n"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"ASP.NET Core"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Attachment Service"})}),(0,n.jsx)(d.td,{children:"Manejo seguro y validaci\xf3n de adjuntos"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:".NET 8"}),", ",(0,n.jsx)(d.code,{children:"S3 SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Validation Service"})}),(0,n.jsx)(d.td,{children:"Validaci\xf3n de datos, l\xedmites y reglas por tenant"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"FluentValidation"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Message Publisher"})}),(0,n.jsxs)(d.td,{children:["Publicaci\xf3n confiable a colas (",(0,n.jsx)(d.code,{children:"outbox pattern"}),")"]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:".NET 8"}),", ",(0,n.jsx)(d.code,{children:"PostgreSQL"}),", ",(0,n.jsx)(d.code,{children:"SQS"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Config Manager"})}),(0,n.jsx)(d.td,{children:"Gesti\xf3n de configuraci\xf3n multi-tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:".NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Structured Logger"})}),(0,n.jsx)(d.td,{children:"Logging estructurado y trazabilidad"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Serilog"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Metrics Collector"})}),(0,n.jsx)(d.td,{children:"Recolecci\xf3n de m\xe9tricas y monitoreo"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Prometheus.NET"})})]})]})]}),"\n",(0,n.jsxs)(d.blockquote,{children:["\n",(0,n.jsxs)(d.p,{children:["La deduplicaci\xf3n, idempotencia y versionado de plantillas est\xe1n integrados como l\xf3gica interna en los componentes cr\xedticos (",(0,n.jsx)(d.code,{children:"Notification API"}),", ",(0,n.jsx)(d.code,{children:"Template Controller"}),", ",(0,n.jsx)(d.code,{children:"Notification Database"}),"), siguiendo el modelo real del sistema. No existen como servicios o contenedores independientes en el DSL."]}),"\n"]}),"\n",(0,n.jsx)(d.h3,{id:"email-processor",children:"Email Processor"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes Email Processor",src:i(42334).A+"",width:"4850",height:"2590"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.3: Componentes internos de Email Processor"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Consumer"})}),(0,n.jsxs)(d.td,{children:["Consume mensajes de la cola de notificaci\xf3n ",(0,n.jsx)(d.code,{children:"email"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Service"})}),(0,n.jsxs)(d.td,{children:["Procesa y env\xeda notificaciones por ",(0,n.jsx)(d.code,{children:"email"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"C# .NET 8"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Adapter"})}),(0,n.jsxs)(d.td,{children:["Env\xeda notificaciones al proveedor externo de ",(0,n.jsx)(d.code,{children:"email"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Repository"})}),(0,n.jsx)(d.td,{children:"Actualiza el estado de las notificaciones enviadas"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"Entity Framework Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Attachment Fetcher"})}),(0,n.jsx)(d.td,{children:"Obtiene archivos adjuntos desde almacenamiento"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Configuration Manager"})}),(0,n.jsx)(d.td,{children:"Gestiona configuraciones del servicio y por tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"sms-processor",children:"SMS Processor"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes SMS Processor",src:i(49125).A+"",width:"4773",height:"2001"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.4: Componentes internos de SMS Processor"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Consumer"})}),(0,n.jsxs)(d.td,{children:["Consume mensajes de la cola notificaci\xf3n ",(0,n.jsx)(d.code,{children:"SMS"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Service"})}),(0,n.jsxs)(d.td,{children:["Procesa y env\xeda notificaciones ",(0,n.jsx)(d.code,{children:"SMS"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"C# .NET 8"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Adapter"})}),(0,n.jsxs)(d.td,{children:["Env\xeda notificaciones al proveedor externo de ",(0,n.jsx)(d.code,{children:"SMS"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Repository"})}),(0,n.jsx)(d.td,{children:"Actualiza el estado de las notificaciones enviadas"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"Entity Framework Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Configuration Manager"})}),(0,n.jsx)(d.td,{children:"Gestiona configuraciones del servicio y por tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"whatsapp-processor",children:"WhatsApp Processor"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes WhatsApp Processor",src:i(49628).A+"",width:"4870",height:"2620"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.5: Componentes internos de WhatsApp Processor"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Consumer"})}),(0,n.jsxs)(d.td,{children:["Consume mensajes de la cola notificaci\xf3n ",(0,n.jsx)(d.code,{children:"WhatsApp"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Service"})}),(0,n.jsxs)(d.td,{children:["Procesa y env\xeda notificaciones ",(0,n.jsx)(d.code,{children:"WhatsApp"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"C# .NET 8"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Adapter"})}),(0,n.jsxs)(d.td,{children:["Env\xeda notificaciones al proveedor externo de ",(0,n.jsx)(d.code,{children:"WhatsApp"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Repository"})}),(0,n.jsx)(d.td,{children:"Actualiza el estado de las notificaciones enviadas"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"Entity Framework Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Attachment Fetcher"})}),(0,n.jsx)(d.td,{children:"Obtiene archivos adjuntos desde almacenamiento"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Configuration Manager"})}),(0,n.jsx)(d.td,{children:"Gestiona configuraciones del servicio y por tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"push-processor",children:"Push Processor"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes Push Processor",src:i(74050).A+"",width:"4865",height:"2580"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.6: Componentes internos de Push Processor"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Consumer"})}),(0,n.jsxs)(d.td,{children:["Consume mensajes de la cola notificaci\xf3n ",(0,n.jsx)(d.code,{children:"Push"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Service"})}),(0,n.jsxs)(d.td,{children:["Procesa y env\xeda notificaciones ",(0,n.jsx)(d.code,{children:"Push"})]}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"C# .NET 8"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Adapter"})}),(0,n.jsxs)(d.td,{children:["Env\xeda notificaciones al proveedor externo de ",(0,n.jsx)(d.code,{children:"Push"})]}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Repository"})}),(0,n.jsx)(d.td,{children:"Actualiza el estado de las notificaciones enviadas"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"Entity Framework Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Attachment Fetcher"})}),(0,n.jsx)(d.td,{children:"Obtiene archivos adjuntos desde almacenamiento"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Configuration Manager"})}),(0,n.jsx)(d.td,{children:"Gestiona configuraciones del servicio y por tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"scheduler",children:"Scheduler"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.img,{alt:"Componentes Scheduler",src:i(29260).A+"",width:"5400",height:"2526"}),"\n",(0,n.jsx)(d.em,{children:"Figura 5.7: Componentes internos de Scheduler"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Componente"}),(0,n.jsx)(d.th,{children:"Responsabilidad"}),(0,n.jsx)(d.th,{children:"Tecnolog\xeda"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Scheduler Worker"})}),(0,n.jsx)(d.td,{children:"Ejecuta tareas programadas para enviar notificaciones"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"Worker Service"}),", ",(0,n.jsx)(d.code,{children:"C# .NET 8"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Service"})}),(0,n.jsx)(d.td,{children:"Procesa y programa el env\xedo de notificaciones"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"C# .NET 8"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Queue Publisher"})}),(0,n.jsx)(d.td,{children:"Env\xeda notificaciones programadas a la cola"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"AWS SDK"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Repository"})}),(0,n.jsx)(d.td,{children:"Acceso a notificaciones programadas en la base de datos"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"Entity Framework Core"})]})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Configuration Manager"})}),(0,n.jsx)(d.td,{children:"Gestiona configuraciones del servicio y por tenant"}),(0,n.jsxs)(d.td,{children:[(0,n.jsx)(d.code,{children:"C# .NET 8"}),", ",(0,n.jsx)(d.code,{children:"EF Core"})]})]})]})]}),"\n",(0,n.jsx)(d.h2,{id:"54-esquemas-de-base-de-datos",children:"5.4 Esquemas De Base De Datos"}),"\n",(0,n.jsx)(d.h2,{id:"541-modelo-de-datos-er",children:"5.4.1 Modelo de Datos (ER)"}),"\n",(0,n.jsx)(d.mermaid,{value:'erDiagram\n    tenant_notification_settings {\n        UUID id PK\n        VARCHAR(50) tenant_id\n        VARCHAR(5) country_code\n        JSONB allowed_channels\n        INTEGER daily_limit\n        VARCHAR(200) default_sender\n        JSONB allowed_hours\n        JSONB preferences\n        BOOLEAN is_active\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n    notifications {\n        UUID id PK\n        VARCHAR(100) request_id\n        VARCHAR(100) message_id\n        VARCHAR(50) tenant_id\n        VARCHAR(5) country_code\n        VARCHAR(100) user_id\n        VARCHAR(50) notification_type\n        JSONB channels\n        JSONB recipient\n        JSONB message_content\n        JSONB schedule\n        JSONB metadata\n        VARCHAR(20) status\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n        TIMESTAMP sent_at\n    }\n    notification_logs {\n        UUID log_id PK\n        VARCHAR(50) tenant_id\n        UUID notification_id FK\n        VARCHAR(20) channel\n        VARCHAR(20) status\n        TEXT error_message\n        INTEGER retry_count\n        TIMESTAMP sent_at\n        TIMESTAMP delivered_at\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n    notification_templates {\n        UUID id PK\n        VARCHAR(50) tenant_id\n        VARCHAR(200) name\n        VARCHAR(20) channel\n        TEXT subject_template\n        TEXT body_template\n        JSONB variables\n        BOOLEAN is_active\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n    scheduled_notifications {\n        UUID id PK\n        VARCHAR(50) tenant_id\n        VARCHAR(100) user_id\n        VARCHAR(50) notification_type\n        JSONB channels\n        TIMESTAMP schedule_time\n        VARCHAR(50) timezone\n        JSONB message_content\n        VARCHAR(20) status\n        VARCHAR(20) priority\n        INTEGER retries_left\n        TIMESTAMP created_at\n        TIMESTAMP updated_at\n    }\n\n    tenant_notification_settings ||--o{ notifications : "1:N"\n    notifications ||--o{ notification_logs : "1:N"\n    tenant_notification_settings ||--o{ notification_templates : "1:N"\n    tenant_notification_settings ||--o{ scheduled_notifications : "1:N"'}),"\n",(0,n.jsx)(d.hr,{}),"\n",(0,n.jsxs)(d.h3,{id:"542-tabla-notifications",children:["5.4.2 Tabla: ",(0,n.jsx)(d.code,{children:"notifications"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"}),(0,n.jsx)(d.th,{children:"Restricciones"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico"}),(0,n.jsx)(d.td,{children:"PRIMARY KEY"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"request_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(100)"}),(0,n.jsx)(d.td,{children:"ID de la solicitud"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(100)"}),(0,n.jsx)(d.td,{children:"ID del mensaje"}),(0,n.jsx)(d.td,{children:"UNIQUE"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"tenant_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Identificador del tenant"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"country_code"}),(0,n.jsx)(d.td,{children:"VARCHAR(5)"}),(0,n.jsx)(d.td,{children:"C\xf3digo de pa\xeds (PE, EC, CO, MX)"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"user_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(100)"}),(0,n.jsx)(d.td,{children:"ID del usuario destinatario"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"notification_type"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"transactional, marketing"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"channels"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Canales solicitados"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Datos del destinatario"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message_content"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Contenido del mensaje"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"schedule"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Configuraci\xf3n de programaci\xf3n"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Metadatos adicionales"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"status"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"pending, processing, sent, failed"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT 'pending'"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"created_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de creaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"updated_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de actualizaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"sent_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de env\xedo"}),(0,n.jsx)(d.td,{children:"NULL"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Ejemplo de datos:"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"id"}),(0,n.jsx)(d.th,{children:"request_id"}),(0,n.jsx)(d.th,{children:"message_id"}),(0,n.jsx)(d.th,{children:"tenant_id"}),(0,n.jsx)(d.th,{children:"country_code"}),(0,n.jsx)(d.th,{children:"user_id"}),(0,n.jsx)(d.th,{children:"notification_type"}),(0,n.jsx)(d.th,{children:"channels"}),(0,n.jsx)(d.th,{children:"recipient"}),(0,n.jsx)(d.th,{children:"message_content"}),(0,n.jsx)(d.th,{children:"schedule"}),(0,n.jsx)(d.th,{children:"metadata"}),(0,n.jsx)(d.th,{children:"status"}),(0,n.jsx)(d.th,{children:"created_at"}),(0,n.jsx)(d.th,{children:"updated_at"}),(0,n.jsx)(d.th,{children:"sent_at"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1e2d3c4b-5a6f-7e8d-9c0b-1a2b3c4d5e6f"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"req-001"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"msg-001"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-pe"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PE"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"usuario789"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"transactional"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email", "sms", "push"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"userId":"usuario789","email":"<usuario@ejemplo.com>"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"subject":"Confirmaci\xf3n de Pedido","body":"\xa1Gracias por su pedido!"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"sendAt":"2024-09-17T15:00:00Z"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"priority":"high","retries":3}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"sent"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"req-002"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"msg-002"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-ec"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EC"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"usuario123"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"marketing"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"userId":"usuario123","email":"<otro@ejemplo.com>"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"subject":"Promo","body":"\xa1Oferta especial solo hoy!"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NULL"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"priority":"low","retries":1}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"pending"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T11:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T11:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NULL"})})]})]})]}),"\n",(0,n.jsxs)(d.h3,{id:"543-tabla-notification_logs",children:["5.4.3 Tabla: ",(0,n.jsx)(d.code,{children:"notification_logs"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"}),(0,n.jsx)(d.th,{children:"Restricciones"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"log_id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico del log"}),(0,n.jsx)(d.td,{children:"PRIMARY KEY"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"tenant_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Identificador del tenant"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"notification_id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Referencia a notification"}),(0,n.jsx)(d.td,{children:"FOREIGN KEY, NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"channel"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"Canal: email, sms, push, whatsapp, in-app"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"status"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"Estado del intento: sent, delivered, failed"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"error_message"}),(0,n.jsx)(d.td,{children:"TEXT"}),(0,n.jsx)(d.td,{children:"Mensaje de error (si aplica)"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"retry_count"}),(0,n.jsx)(d.td,{children:"INTEGER"}),(0,n.jsx)(d.td,{children:"N\xfamero de reintentos en este intento"}),(0,n.jsx)(d.td,{children:"DEFAULT 0"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"sent_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha/hora de env\xedo"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"delivered_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha/hora de entrega confirmada"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"created_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de creaci\xf3n del log"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"updated_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de actualizaci\xf3n del log"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Ejemplo de datos:"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"log_id"}),(0,n.jsx)(d.th,{children:"tenant_id"}),(0,n.jsx)(d.th,{children:"notification_id"}),(0,n.jsx)(d.th,{children:"channel"}),(0,n.jsx)(d.th,{children:"status"}),(0,n.jsx)(d.th,{children:"error_message"}),(0,n.jsx)(d.th,{children:"retry_count"}),(0,n.jsx)(d.th,{children:"sent_at"}),(0,n.jsx)(d.th,{children:"delivered_at"}),(0,n.jsx)(d.th,{children:"created_at"}),(0,n.jsx)(d.th,{children:"updated_at"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-pe"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1e2d3c4b-5a6f-7e8d-9c0b-1a2b3c4d5e6f"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"email"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"sent"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NULL"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"0"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:10Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:00Z"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2b3c4d5e-6f7a-8b9c-0d1e-2f3a4b5c6d7e"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-pe"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1e2d3c4b-5a6f-7e8d-9c0b-1a2b3c4d5e6f"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"sms"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"failed"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"Timeout"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:05Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"NULL"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:05Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T10:01:05Z"})})]})]})]}),"\n",(0,n.jsx)(d.hr,{}),"\n",(0,n.jsxs)(d.h3,{id:"544-tabla-notification_templates",children:["5.4.4 Tabla: ",(0,n.jsx)(d.code,{children:"notification_templates"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"}),(0,n.jsx)(d.th,{children:"Restricciones"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico"}),(0,n.jsx)(d.td,{children:"PRIMARY KEY"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"tenant_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Identificador del tenant"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"name"}),(0,n.jsx)(d.td,{children:"VARCHAR(200)"}),(0,n.jsx)(d.td,{children:"Nombre descriptivo"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"channel"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"Canal: email, sms, push, whatsapp, in-app"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"subject_template"}),(0,n.jsx)(d.td,{children:"TEXT"}),(0,n.jsx)(d.td,{children:"Template del asunto"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"body_template"}),(0,n.jsx)(d.td,{children:"TEXT"}),(0,n.jsx)(d.td,{children:"Template del cuerpo"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"variables"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Variables disponibles"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"is_active"}),(0,n.jsx)(d.td,{children:"BOOLEAN"}),(0,n.jsx)(d.td,{children:"Estado del template"}),(0,n.jsx)(d.td,{children:"DEFAULT true"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"created_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de creaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"updated_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de actualizaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Ejemplo de datos:"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"id"}),(0,n.jsx)(d.th,{children:"tenant_id"}),(0,n.jsx)(d.th,{children:"name"}),(0,n.jsx)(d.th,{children:"channel"}),(0,n.jsx)(d.th,{children:"subject_template"}),(0,n.jsx)(d.th,{children:"body_template"}),(0,n.jsx)(d.th,{children:"variables"}),(0,n.jsx)(d.th,{children:"is_active"}),(0,n.jsx)(d.th,{children:"created_at"}),(0,n.jsx)(d.th,{children:"updated_at"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-pe"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Confirmaci\xf3n de Pedido"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"email"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"Confirmaci\xf3n de Pedido"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"\xa1Gracias por su pedido, {{user}}!"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"user":"string","orderId":"int"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"true"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T09:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T09:00:00Z"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"4d5e6f7a-8b9c-0d1e-2f3a-4b5c6d7e8f9a"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-ec"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"Promoci\xf3n Especial"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"email"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"Promo"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"\xa1Oferta solo hoy, {{user}}!"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"user":"string"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"true"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T09:30:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T09:30:00Z"})})]})]})]}),"\n",(0,n.jsx)(d.hr,{}),"\n",(0,n.jsxs)(d.h3,{id:"545-tabla-scheduled_notifications",children:["5.4.5 Tabla: ",(0,n.jsx)(d.code,{children:"scheduled_notifications"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"}),(0,n.jsx)(d.th,{children:"Restricciones"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico"}),(0,n.jsx)(d.td,{children:"PRIMARY KEY"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"tenant_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Identificador del tenant"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"user_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(100)"}),(0,n.jsx)(d.td,{children:"ID del usuario destinatario"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"notification_type"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"transactional, marketing, alert"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"channels"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Canales solicitados"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"schedule_time"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha/hora programada de env\xedo"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"timezone"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Zona horaria"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message_content"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Contenido del mensaje"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"status"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"pending, scheduled, sent, failed"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT 'pending'"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"priority"}),(0,n.jsx)(d.td,{children:"VARCHAR(20)"}),(0,n.jsx)(d.td,{children:"Prioridad de la notificaci\xf3n"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"retries_left"}),(0,n.jsx)(d.td,{children:"INTEGER"}),(0,n.jsx)(d.td,{children:"Reintentos restantes"}),(0,n.jsx)(d.td,{children:"DEFAULT 0"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"created_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de creaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"updated_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de actualizaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Ejemplo de datos:"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"id"}),(0,n.jsx)(d.th,{children:"tenant_id"}),(0,n.jsx)(d.th,{children:"user_id"}),(0,n.jsx)(d.th,{children:"notification_type"}),(0,n.jsx)(d.th,{children:"channels"}),(0,n.jsx)(d.th,{children:"schedule_time"}),(0,n.jsx)(d.th,{children:"timezone"}),(0,n.jsx)(d.th,{children:"message_content"}),(0,n.jsx)(d.th,{children:"status"}),(0,n.jsx)(d.th,{children:"priority"}),(0,n.jsx)(d.th,{children:"retries_left"}),(0,n.jsx)(d.th,{children:"created_at"}),(0,n.jsx)(d.th,{children:"updated_at"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-co"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"usuario789"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"transactional"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email","sms"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-14T09:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"America/Lima"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"subject":"Recordatorio","body":"No olvide su cita"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"scheduled"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"high"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T08:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T08:00:00Z"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"6f7a8b9c-0d1e-2f3a-4b5c-6d7e8f9a0b1c"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-mx"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"usuario123"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"marketing"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-15T10:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"UTC"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"subject":"Promo","body":"\xa1Solo hoy!"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"pending"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"low"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T08:30:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T08:30:00Z"})})]})]})]}),"\n",(0,n.jsx)(d.hr,{}),"\n",(0,n.jsxs)(d.h3,{id:"546-tabla-tenant_notification_settings",children:["5.4.6 Tabla: ",(0,n.jsx)(d.code,{children:"tenant_notification_settings"})]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"}),(0,n.jsx)(d.th,{children:"Restricciones"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"id"}),(0,n.jsx)(d.td,{children:"UUID"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico"}),(0,n.jsx)(d.td,{children:"PRIMARY KEY"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"tenant_id"}),(0,n.jsx)(d.td,{children:"VARCHAR(50)"}),(0,n.jsx)(d.td,{children:"Identificador del tenant"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"country_code"}),(0,n.jsx)(d.td,{children:"VARCHAR(5)"}),(0,n.jsx)(d.td,{children:"C\xf3digo de pa\xeds (PE, EC, CO, MX)"}),(0,n.jsx)(d.td,{children:"NOT NULL, INDEX"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"allowed_channels"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Canales permitidos (email, sms, push, etc.)"}),(0,n.jsx)(d.td,{children:"NOT NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"daily_limit"}),(0,n.jsx)(d.td,{children:"INTEGER"}),(0,n.jsx)(d.td,{children:"L\xedmite diario de notificaciones"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"default_sender"}),(0,n.jsx)(d.td,{children:"VARCHAR(200)"}),(0,n.jsx)(d.td,{children:"Remitente por defecto (email, nombre, etc.)"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"allowed_hours"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Horarios permitidos para env\xedo (ej: [8,21])"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"preferences"}),(0,n.jsx)(d.td,{children:"JSONB"}),(0,n.jsx)(d.td,{children:"Preferencias adicionales (idioma, formato, etc.)"}),(0,n.jsx)(d.td,{children:"NULL"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"is_active"}),(0,n.jsx)(d.td,{children:"BOOLEAN"}),(0,n.jsx)(d.td,{children:"Configuraci\xf3n activa"}),(0,n.jsx)(d.td,{children:"DEFAULT true"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"created_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de creaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"updated_at"}),(0,n.jsx)(d.td,{children:"TIMESTAMP"}),(0,n.jsx)(d.td,{children:"Fecha de actualizaci\xf3n"}),(0,n.jsx)(d.td,{children:"NOT NULL, DEFAULT NOW()"})]})]})]}),"\n",(0,n.jsx)(d.p,{children:(0,n.jsx)(d.strong,{children:"Ejemplo de datos:"})}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"id"}),(0,n.jsx)(d.th,{children:"tenant_id"}),(0,n.jsx)(d.th,{children:"country_code"}),(0,n.jsx)(d.th,{children:"allowed_channels"}),(0,n.jsx)(d.th,{children:"daily_limit"}),(0,n.jsx)(d.th,{children:"default_sender"}),(0,n.jsx)(d.th,{children:"allowed_hours"}),(0,n.jsx)(d.th,{children:"preferences"}),(0,n.jsx)(d.th,{children:"is_active"}),(0,n.jsx)(d.th,{children:"created_at"}),(0,n.jsx)(d.th,{children:"updated_at"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-pe"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"PE"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email","sms","push"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"1000"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"<notificaciones@acme.com>"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"[8,21]"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"idioma":"es","formato":"html"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"true"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T07:00:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T07:00:00Z"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"tenant-ec"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"EC"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'["email"]'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"500"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'"<info@ejemplo.com>"'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"[9,18]"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'{"idioma":"en"}'})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"true"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T07:30:00Z"})}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"2025-08-13T07:30:00Z"})})]})]})]}),"\n",(0,n.jsx)(d.h2,{id:"55-endpoints-de-api",children:"5.5 Endpoints De API"}),"\n",(0,n.jsx)(d.p,{children:"Se describen los principales endpoints REST para la gesti\xf3n y consulta de notificaciones y plantillas. Los contratos de datos siguen el est\xe1ndar DTO y est\xe1n alineados con la arquitectura Clean Architecture."}),"\n",(0,n.jsx)(d.h3,{id:"551-notification-api",children:"5.5.1 Notification API"}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:["POST ",(0,n.jsx)(d.code,{children:"/api/v1/notifications"}),": Enviar nueva notificaci\xf3n"]}),"\n",(0,n.jsxs)(d.li,{children:["GET ",(0,n.jsx)(d.code,{children:"/api/v1/notifications/{notificationId}"}),": Consultar estado de notificaci\xf3n"]}),"\n"]}),"\n",(0,n.jsx)(d.h3,{id:"552-attachment-api",children:"5.5.2 Attachment API"}),"\n",(0,n.jsxs)(d.ul,{children:["\n",(0,n.jsxs)(d.li,{children:["POST ",(0,n.jsx)(d.code,{children:"/api/v1/attachments/upload"}),": Subir un archivo adjunto (multipart/form-data)"]}),"\n",(0,n.jsxs)(d.li,{children:["GET ",(0,n.jsx)(d.code,{children:"/api/v1/attachments/{attachmentId}/download"}),": Descargar un archivo adjunto"]}),"\n",(0,n.jsxs)(d.li,{children:["DELETE ",(0,n.jsx)(d.code,{children:"/api/v1/attachments/{attachmentId}"}),": Eliminar un archivo adjunto"]}),"\n"]}),"\n",(0,n.jsxs)(d.blockquote,{children:["\n",(0,n.jsx)(d.p,{children:"Los adjuntos se almacenan en S3 y se asocian a notificaciones mediante URLs seguras. El endpoint de carga retorna la URL de acceso y el identificador del adjunto."}),"\n"]}),"\n",(0,n.jsx)(d.h2,{id:"56-contratos-de-datos-dtos",children:"5.6 Contratos De Datos (DTOs)"}),"\n",(0,n.jsx)(d.p,{children:"Los siguientes contratos definen la estructura de los datos de entrada y salida de la API:"}),"\n",(0,n.jsx)(d.h3,{id:"561-notificationrequest-contrato",children:"5.6.1 NotificationRequest (Contrato)"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"Campo"}),(0,n.jsx)(d.th,{children:"Tipo"}),(0,n.jsx)(d.th,{children:"Descripci\xf3n"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"requestId"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Identificador \xfanico de la solicitud"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"timestamp"}),(0,n.jsx)(d.td,{children:"string (ISO 8601)"}),(0,n.jsx)(d.td,{children:"Fecha y hora de la solicitud"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"notificationType"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:'Tipo de notificaci\xf3n: "transactional", "marketing", "alert"'})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"channels"}),(0,n.jsx)(d.td,{children:"array de string"}),(0,n.jsx)(d.td,{children:"Canales solicitados"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient"}),(0,n.jsx)(d.td,{children:"objeto"}),(0,n.jsx)(d.td,{children:"Informaci\xf3n del destinatario (ver subcampos)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient.userId"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Identificador del usuario"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient.email"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Correo electr\xf3nico del destinatario"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient.phone"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Tel\xe9fono del destinatario"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient.pushToken"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Token push"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"recipient.customFields"}),(0,n.jsx)(d.td,{children:"objeto (opcional)"}),(0,n.jsx)(d.td,{children:"Campos personalizados del destinatario"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message"}),(0,n.jsx)(d.td,{children:"objeto"}),(0,n.jsx)(d.td,{children:"Contenido del mensaje (ver subcampos)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.subject"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Asunto (para email)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.body"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Cuerpo del mensaje"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.attachments"}),(0,n.jsx)(d.td,{children:"array de string (op)"}),(0,n.jsx)(d.td,{children:"URLs de adjuntos"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.smsText"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Texto SMS"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification"}),(0,n.jsx)(d.td,{children:"objeto (op)"}),(0,n.jsx)(d.td,{children:"Datos para notificaci\xf3n push (ver subcampos)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.title"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"T\xedtulo de la notificaci\xf3n push"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.body"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Cuerpo de la notificaci\xf3n push"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.icon"}),(0,n.jsx)(d.td,{children:"string (op)"}),(0,n.jsx)(d.td,{children:"URL de icono"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.action"}),(0,n.jsx)(d.td,{children:"objeto (op)"}),(0,n.jsx)(d.td,{children:"Acci\xf3n asociada"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.action.type"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Tipo de acci\xf3n"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"message.pushNotification.action.url"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"URL destino"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"schedule"}),(0,n.jsx)(d.td,{children:"objeto (opcional)"}),(0,n.jsx)(d.td,{children:"Programaci\xf3n de env\xedo (ver subcampos)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"schedule.sendAt"}),(0,n.jsx)(d.td,{children:"string (ISO 8601)"}),(0,n.jsx)(d.td,{children:"Fecha/hora de env\xedo programado"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"schedule.timeZone"}),(0,n.jsx)(d.td,{children:"string (opcional)"}),(0,n.jsx)(d.td,{children:"Zona horaria"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata"}),(0,n.jsx)(d.td,{children:"objeto (opcional)"}),(0,n.jsx)(d.td,{children:"Metadatos adicionales (prioridad, reintentos, etc.)"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata.priority"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Prioridad de la notificaci\xf3n"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata.retries"}),(0,n.jsx)(d.td,{children:"integer"}),(0,n.jsx)(d.td,{children:"N\xfamero de reintentos permitidos"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata.sentBy"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Servicio o sistema que origina la notificaci\xf3n"})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:"metadata.templateId"}),(0,n.jsx)(d.td,{children:"string"}),(0,n.jsx)(d.td,{children:"Identificador de la plantilla utilizada"})]})]})]}),"\n",(0,n.jsx)(d.h4,{id:"ejemplo-de-contrato-notificationrequest",children:"Ejemplo de contrato NotificationRequest"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-json",children:'{\n  "requestId": "abc123",\n  "timestamp": "2024-09-17T14:00:00Z",\n  "notificationType": "transactional",\n  "channels": ["email", "sms", "push"],\n  "recipient": {\n    "userId": "usuario789",\n    "email": "usuario@ejemplo.com"\n  },\n  "message": {\n    "subject": "Confirmaci\xf3n de Pedido",\n    "body": "\xa1Gracias por su pedido! Su pedido #123456 ha sido confirmado.",\n    "attachments": ["https://ejemplo.com/factura123456.pdf"],\n    "smsText": "\xa1Gracias por su pedido! Pedido #123456 confirmado.",\n    "pushNotification": {\n      "title": "Pedido Confirmado",\n      "body": "Su pedido #123456 ha sido confirmado. Revise su correo para m\xe1s detalles.",\n      "icon": "https://ejemplo.com/icono.png",\n      "action": {\n        "type": "verPedido",\n        "url": "https://ejemplo.com/pedido/123456"\n      }\n    }\n  },\n  "schedule": {\n    "sendAt": "2024-09-17T15:00:00Z"\n  },\n  "metadata": {\n    "priority": "high",\n    "retries": 3,\n    "sentBy": "OrderService",\n    "templateId": "orderConfirmationTemplate"\n  }\n}\n'})})]})}function a(e={}){const{wrapper:d}={...(0,c.R)(),...e.components};return d?(0,n.jsx)(d,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},74050:(e,d,i)=>{i.d(d,{A:()=>s});const s=i.p+"assets/images/notification_system_push_processor-04cc9295c854abaf77c6eb05b9e75cf9.png"}}]);